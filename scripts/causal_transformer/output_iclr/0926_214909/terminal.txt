------------- Preparing model -------------
Total parameters: 25219072
Trainable parameters: 25219072
------------- Preparing data -------------
max_seen_len for counting_selective_10items2bos = 51
num train = 1000000
num val = 2000
------------ Start job 0926_214909 ------------
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 2.6142 
                        | Val Acc: 0.0785 
                        | Val Counting Acc: 0.0785 
                        | Val Last Acc: 0.0775
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 2.661
                            | Test Acc: 0.0861
                            | Test Counting Acc: 0.0863
                            | Test Last Acc: 0.0693
                            | Test Unseen Len Acc: 0.0823
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.4228 
                    | Val Acc: 0.967 
                    | Val Counting Acc: 0.9679 
                    | Val Last Acc: 0.9445
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.0204
                    | Test Acc: 0.9
                    | Test Counting Acc: 0.9027
                    | Test Last Acc: 0.6982
                    | Test Unseen Len Acc: 0.7968
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0021 
                    | Val Acc: 0.9994 
                    | Val Counting Acc: 0.9994 
                    | Val Last Acc: 0.998
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 0.0972
                    | Test Acc: 0.9734
                    | Test Counting Acc: 0.9751
                    | Test Last Acc: 0.8494
                    | Test Unseen Len Acc: 0.9191
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 0.0057
                            | Test Acc: 0.9983
                            | Test Counting Acc: 0.9985
                            | Test Last Acc: 0.9829
                            | Test Unseen Len Acc: 0.9947
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 0.0071
                    | Test Acc: 0.9976
                    | Test Counting Acc: 0.998
                    | Test Last Acc: 0.9729
                    | Test Unseen Len Acc: 0.9926
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0012 
                    | Val Acc: 0.9996 
                    | Val Counting Acc: 0.9996 
                    | Val Last Acc: 0.999
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 0.0242
                    | Test Acc: 0.9925
                    | Test Counting Acc: 0.9931
                    | Test Last Acc: 0.9468
                    | Test Unseen Len Acc: 0.9772
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0065 
                    | Val Acc: 0.9975 
                    | Val Counting Acc: 0.9978 
                    | Val Last Acc: 0.9915
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 0.0908
                    | Test Acc: 0.9712
                    | Test Counting Acc: 0.9723
                    | Test Last Acc: 0.8903
                    | Test Unseen Len Acc: 0.9158
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 0.0023
                            | Test Acc: 0.9992
                            | Test Counting Acc: 0.9992
                            | Test Last Acc: 0.9933
                            | Test Unseen Len Acc: 0.9974
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 0.001
                    | Test Acc: 0.9997
                    | Test Counting Acc: 0.9998
                    | Test Last Acc: 0.9967
                    | Test Unseen Len Acc: 0.9991
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.002 
                    | Val Acc: 0.9991 
                    | Val Counting Acc: 0.9992 
                    | Val Last Acc: 0.996
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 0.0102
                    | Test Acc: 0.9956
                    | Test Counting Acc: 0.9958
                    | Test Last Acc: 0.9796
                    | Test Unseen Len Acc: 0.9873
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 0.001
                            | Test Acc: 0.9996
                            | Test Counting Acc: 0.9997
                            | Test Last Acc: 0.996
                            | Test Unseen Len Acc: 0.9988
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 0.0004
                    | Test Acc: 0.9998
                    | Test Counting Acc: 0.9998
                    | Test Last Acc: 0.9987
                    | Test Unseen Len Acc: 0.9995
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 0.0001
                    | Test Acc: 1.0
                    | Test Counting Acc: 1.0
                    | Test Last Acc: 0.9997
                    | Test Unseen Len Acc: 0.9999
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0002 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 0.0088
                    | Test Acc: 0.997
                    | Test Counting Acc: 0.9973
                    | Test Last Acc: 0.9796
                    | Test Unseen Len Acc: 0.9908


------------- Start Inference -------------


---------------------- 0926_214909 ----------------------
max_seen_len for counting_selective_10items2bos = 51
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.3844 
                | Test Acc: 0.9685 
                | Test Counting Acc: 0.9693 
                | Test Last Acc: 0.9483
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.0344 
                | Test Acc: 0.8992 
                | Test Counting Acc: 0.902 
                | Test Last Acc: 0.6938
                | Test Unseen Len Acc: 0.7951
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0023 
                | Test Acc: 0.9992 
                | Test Counting Acc: 0.9993 
                | Test Last Acc: 0.9974
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0967 
                | Test Acc: 0.9736 
                | Test Counting Acc: 0.9752 
                | Test Last Acc: 0.8572
                | Test Unseen Len Acc: 0.9194
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0071 
                | Test Acc: 0.9976 
                | Test Counting Acc: 0.9979 
                | Test Last Acc: 0.9757
                | Test Unseen Len Acc: 0.9926
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.001 
                | Test Acc: 0.9998 
                | Test Counting Acc: 0.9998 
                | Test Last Acc: 0.9992
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0241 
                | Test Acc: 0.9927 
                | Test Counting Acc: 0.9933 
                | Test Last Acc: 0.9515
                | Test Unseen Len Acc: 0.9779
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0064 
                | Test Acc: 0.9972 
                | Test Counting Acc: 0.9975 
                | Test Last Acc: 0.9901
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0917 
                | Test Acc: 0.9704 
                | Test Counting Acc: 0.9715 
                | Test Last Acc: 0.8901
                | Test Unseen Len Acc: 0.9135
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0008 
                | Test Acc: 0.9998 
                | Test Counting Acc: 0.9998 
                | Test Last Acc: 0.9972
                | Test Unseen Len Acc: 0.9992
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0017 
                | Test Acc: 0.9993 
                | Test Counting Acc: 0.9994 
                | Test Last Acc: 0.9963
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0091 
                | Test Acc: 0.9962 
                | Test Counting Acc: 0.9964 
                | Test Last Acc: 0.9821
                | Test Unseen Len Acc: 0.9889
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0004 
                | Test Acc: 0.9998 
                | Test Counting Acc: 0.9999 
                | Test Last Acc: 0.9983
                | Test Unseen Len Acc: 0.9995
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 0.0001 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 0.9997
                | Test Unseen Len Acc: 0.9999
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0002 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0081 
                | Test Acc: 0.9973 
                | Test Counting Acc: 0.9975 
                | Test Last Acc: 0.9808
                | Test Unseen Len Acc: 0.9915
            
Finish!!! 0926_214909
