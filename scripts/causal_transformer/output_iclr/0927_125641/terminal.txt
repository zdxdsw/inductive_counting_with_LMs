------------- Preparing model -------------
Total parameters: 12753920
Trainable parameters: 12753920
------------- Preparing data -------------
max_seen_len for counting_selective_10items2bos = 51
num train = 1000000
num val = 2000
resume from ckpt: 9_312500_transformer.pt
	epoch 10 step 312501
------------ Start job 0927_125641 ------------
k = 2000, last_demo = 2000
Epoch 10 Step 320000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 10 Step 320000 ood_test.txt
                            | Test Loss: 0.113
                            | Test Acc: 0.971
                            | Test Counting Acc: 0.9735
                            | Test Last Acc: 0.7795
                            | Test Unseen Len Acc: 0.9092
k = 2000, last_demo = 2000
Epoch 10 Step 343751 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 10 Step 343751 ood_test.txt
                    | Test Loss: 0.1387
                    | Test Acc: 0.9633
                    | Test Counting Acc: 0.9666
                    | Test Last Acc: 0.717
                    | Test Unseen Len Acc: 0.8853
k = 2000, last_demo = 2000
Epoch 11 Step 375001 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 11 Step 375001 ood_test.txt
                    | Test Loss: 0.1019
                    | Test Acc: 0.9724
                    | Test Counting Acc: 0.975
                    | Test Last Acc: 0.7845
                    | Test Unseen Len Acc: 0.9138
k = 2000, last_demo = 2000
Epoch 12 Step 400000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 12 Step 400000 ood_test.txt
                            | Test Loss: 0.129
                            | Test Acc: 0.965
                            | Test Counting Acc: 0.9681
                            | Test Last Acc: 0.7407
                            | Test Unseen Len Acc: 0.8908
k = 2000, last_demo = 2000
Epoch 12 Step 406251 
                    | Val Loss: 0.0002 
                    | Val Acc: 0.9999 
                    | Val Counting Acc: 0.9999 
                    | Val Last Acc: 0.999
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 12 Step 406251 ood_test.txt
                    | Test Loss: 0.083
                    | Test Acc: 0.98
                    | Test Counting Acc: 0.9812
                    | Test Last Acc: 0.8876
                    | Test Unseen Len Acc: 0.9375
k = 2000, last_demo = 2000
Epoch 13 Step 437501 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 13 Step 437501 ood_test.txt
                    | Test Loss: 0.0909
                    | Test Acc: 0.9814
                    | Test Counting Acc: 0.9833
                    | Test Last Acc: 0.8364
                    | Test Unseen Len Acc: 0.9418
k = 2000, last_demo = 2000
Epoch 14 Step 468751 
                    | Val Loss: 0.0003 
                    | Val Acc: 0.9999 
                    | Val Counting Acc: 0.9999 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 14 Step 468751 ood_test.txt
                    | Test Loss: 0.2027
                    | Test Acc: 0.9538
                    | Test Counting Acc: 0.9567
                    | Test Last Acc: 0.734
                    | Test Unseen Len Acc: 0.8557
k = 2000, last_demo = 2000
Epoch 15 Step 480000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 15 Step 480000 ood_test.txt
                            | Test Loss: 0.1195
                            | Test Acc: 0.9679
                            | Test Counting Acc: 0.9702
                            | Test Last Acc: 0.7946
                            | Test Unseen Len Acc: 0.8996
k = 2000, last_demo = 2000
Epoch 15 Step 500001 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 15 Step 500001 ood_test.txt
                    | Test Loss: 0.0306
                    | Test Acc: 0.99
                    | Test Counting Acc: 0.9908
                    | Test Last Acc: 0.9274
                    | Test Unseen Len Acc: 0.9687
k = 2000, last_demo = 2000
Epoch 16 Step 531251 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 16 Step 531251 ood_test.txt
                    | Test Loss: 0.0227
                    | Test Acc: 0.9925
                    | Test Counting Acc: 0.9931
                    | Test Last Acc: 0.9468
                    | Test Unseen Len Acc: 0.9764
k = 2000, last_demo = 2000
Epoch 17 Step 560000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 17 Step 560000 ood_test.txt
                            | Test Loss: 0.0244
                            | Test Acc: 0.9918
                            | Test Counting Acc: 0.9926
                            | Test Last Acc: 0.9351
                            | Test Unseen Len Acc: 0.9744
k = 2000, last_demo = 2000
Epoch 17 Step 562501 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 17 Step 562501 ood_test.txt
                    | Test Loss: 0.022
                    | Test Acc: 0.9927
                    | Test Counting Acc: 0.9933
                    | Test Last Acc: 0.9502
                    | Test Unseen Len Acc: 0.9773
k = 2000, last_demo = 2000
Epoch 18 Step 593751 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 18 Step 593751 ood_test.txt
                    | Test Loss: 0.0232
                    | Test Acc: 0.9925
                    | Test Counting Acc: 0.9932
                    | Test Last Acc: 0.9415
                    | Test Unseen Len Acc: 0.9766
k = 2000, last_demo = 2000
Epoch 19 Step 625001 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 19 Step 625001 ood_test.txt
                    | Test Loss: 0.0055
                    | Test Acc: 0.9982
                    | Test Counting Acc: 0.9984
                    | Test Last Acc: 0.9829
                    | Test Unseen Len Acc: 0.9943


------------- Start Inference -------------


---------------------- 0927_125641 ----------------------
max_seen_len for counting_selective_10items2bos = 51
 val acc, load from 10_343751_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 10_343751_transformer.pt
                | Test Loss: 0.138 
                | Test Acc: 0.9635 
                | Test Counting Acc: 0.9668 
                | Test Last Acc: 0.7173
                | Test Unseen Len Acc: 0.8858
            
 val acc, load from 11_375001_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 11_375001_transformer.pt
                | Test Loss: 0.1013 
                | Test Acc: 0.9727 
                | Test Counting Acc: 0.9752 
                | Test Last Acc: 0.7863
                | Test Unseen Len Acc: 0.9146
            
 val acc, load from 12_406251_transformer.pt
                | Test Loss: 0.0001 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 0.9996
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 12_406251_transformer.pt
                | Test Loss: 0.082 
                | Test Acc: 0.9798 
                | Test Counting Acc: 0.981 
                | Test Last Acc: 0.8887
                | Test Unseen Len Acc: 0.9369
            
 val acc, load from 13_437501_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 13_437501_transformer.pt
                | Test Loss: 0.0911 
                | Test Acc: 0.9816 
                | Test Counting Acc: 0.9835 
                | Test Last Acc: 0.8387
                | Test Unseen Len Acc: 0.9424
            
 val acc, load from 14_468751_transformer.pt
                | Test Loss: 0.0002 
                | Test Acc: 0.9999 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 0.9996
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 14_468751_transformer.pt
                | Test Loss: 0.2026 
                | Test Acc: 0.9537 
                | Test Counting Acc: 0.9567 
                | Test Last Acc: 0.7293
                | Test Unseen Len Acc: 0.8553
            
 val acc, load from 15_500001_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 15_500001_transformer.pt
                | Test Loss: 0.0302 
                | Test Acc: 0.9902 
                | Test Counting Acc: 0.991 
                | Test Last Acc: 0.9285
                | Test Unseen Len Acc: 0.9693
            
 val acc, load from 16_531251_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 16_531251_transformer.pt
                | Test Loss: 0.0232 
                | Test Acc: 0.9923 
                | Test Counting Acc: 0.9929 
                | Test Last Acc: 0.9482
                | Test Unseen Len Acc: 0.976
            
 val acc, load from 17_562501_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 17_562501_transformer.pt
                | Test Loss: 0.0218 
                | Test Acc: 0.9927 
                | Test Counting Acc: 0.9932 
                | Test Last Acc: 0.9514
                | Test Unseen Len Acc: 0.9771
            
 val acc, load from 18_593751_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 18_593751_transformer.pt
                | Test Loss: 0.0234 
                | Test Acc: 0.9925 
                | Test Counting Acc: 0.9932 
                | Test Last Acc: 0.9448
                | Test Unseen Len Acc: 0.9766
            
 val acc, load from 19_625001_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 19_625001_transformer.pt
                | Test Loss: 0.0055 
                | Test Acc: 0.9982 
                | Test Counting Acc: 0.9984 
                | Test Last Acc: 0.9846
                | Test Unseen Len Acc: 0.9943
            
Finish!!! 0927_125641
