------------- Preparing model -------------
Total parameters: 12622848
Trainable parameters: 12622848
------------- Preparing data -------------
max_seen_len for counting_selective_10items2bos = 51
num train = 1000000
num val = 2000
------------ Start job 0926_230957 ------------
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 2.3876 
                        | Val Acc: 0.1746 
                        | Val Counting Acc: 0.175 
                        | Val Last Acc: 0.166
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 2.4693
                            | Test Acc: 0.1287
                            | Test Counting Acc: 0.1302
                            | Test Last Acc: 0.0224
                            | Test Unseen Len Acc: 0.0366
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.0013 
                    | Val Acc: 0.9994 
                    | Val Counting Acc: 0.9994 
                    | Val Last Acc: 0.9985
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 0.0756
                    | Test Acc: 0.9744
                    | Test Counting Acc: 0.976
                    | Test Last Acc: 0.8518
                    | Test Unseen Len Acc: 0.9203
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0118 
                    | Val Acc: 0.9946 
                    | Val Counting Acc: 0.995 
                    | Val Last Acc: 0.986
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 0.1307
                    | Test Acc: 0.9595
                    | Test Counting Acc: 0.9608
                    | Test Last Acc: 0.8581
                    | Test Unseen Len Acc: 0.888
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.013 
                        | Val Acc: 0.9955 
                        | Val Counting Acc: 0.9962 
                        | Val Last Acc: 0.9785
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 0.1162
                            | Test Acc: 0.9711
                            | Test Counting Acc: 0.9715
                            | Test Last Acc: 0.9401
                            | Test Unseen Len Acc: 0.9273
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 0.0346
                    | Test Acc: 0.9899
                    | Test Counting Acc: 0.9907
                    | Test Last Acc: 0.9287
                    | Test Unseen Len Acc: 0.9684
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0163 
                    | Val Acc: 0.9942 
                    | Val Counting Acc: 0.9949 
                    | Val Last Acc: 0.9775
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 0.0714
                    | Test Acc: 0.9755
                    | Test Counting Acc: 0.9764
                    | Test Last Acc: 0.9063
                    | Test Unseen Len Acc: 0.9308
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 0.1247
                    | Test Acc: 0.9627
                    | Test Counting Acc: 0.9648
                    | Test Last Acc: 0.811
                    | Test Unseen Len Acc: 0.8835
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.0081 
                        | Val Acc: 0.9971 
                        | Val Counting Acc: 0.9973 
                        | Val Last Acc: 0.99
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 0.0349
                            | Test Acc: 0.9858
                            | Test Counting Acc: 0.9868
                            | Test Last Acc: 0.912
                            | Test Unseen Len Acc: 0.9567
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 0.0212
                    | Test Acc: 0.9926
                    | Test Counting Acc: 0.9932
                    | Test Last Acc: 0.9491
                    | Test Unseen Len Acc: 0.9769
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 0.0367
                    | Test Acc: 0.9903
                    | Test Counting Acc: 0.9911
                    | Test Last Acc: 0.9267
                    | Test Unseen Len Acc: 0.9696
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 0.0222
                            | Test Acc: 0.9928
                            | Test Counting Acc: 0.9935
                            | Test Last Acc: 0.9364
                            | Test Unseen Len Acc: 0.9774
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 0.02
                    | Test Acc: 0.9933
                    | Test Counting Acc: 0.9939
                    | Test Last Acc: 0.9491
                    | Test Unseen Len Acc: 0.979
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.1256 
                    | Val Acc: 0.9677 
                    | Val Counting Acc: 0.9686 
                    | Val Last Acc: 0.946
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 0.3636
                    | Test Acc: 0.9296
                    | Test Counting Acc: 0.9301
                    | Test Last Acc: 0.8919
                    | Test Unseen Len Acc: 0.8977
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 0.1018
                    | Test Acc: 0.9737
                    | Test Counting Acc: 0.9754
                    | Test Last Acc: 0.8481
                    | Test Unseen Len Acc: 0.9178


------------- Start Inference -------------


---------------------- 0926_230957 ----------------------
max_seen_len for counting_selective_10items2bos = 51
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.0013 
                | Test Acc: 0.9994 
                | Test Counting Acc: 0.9994 
                | Test Last Acc: 0.9985
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 0.0736 
                | Test Acc: 0.9748 
                | Test Counting Acc: 0.9764 
                | Test Last Acc: 0.8538
                | Test Unseen Len Acc: 0.9215
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0114 
                | Test Acc: 0.9945 
                | Test Counting Acc: 0.9948 
                | Test Last Acc: 0.986
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 0.1323 
                | Test Acc: 0.9588 
                | Test Counting Acc: 0.9602 
                | Test Last Acc: 0.8568
                | Test Unseen Len Acc: 0.8864
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0348 
                | Test Acc: 0.9896 
                | Test Counting Acc: 0.9905 
                | Test Last Acc: 0.9264
                | Test Unseen Len Acc: 0.9676
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0164 
                | Test Acc: 0.9941 
                | Test Counting Acc: 0.9947 
                | Test Last Acc: 0.9785
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0709 
                | Test Acc: 0.9753 
                | Test Counting Acc: 0.9763 
                | Test Last Acc: 0.9063
                | Test Unseen Len Acc: 0.9304
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 0.1264 
                | Test Acc: 0.962 
                | Test Counting Acc: 0.9641 
                | Test Last Acc: 0.8076
                | Test Unseen Len Acc: 0.8813
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0214 
                | Test Acc: 0.9925 
                | Test Counting Acc: 0.9931 
                | Test Last Acc: 0.9488
                | Test Unseen Len Acc: 0.9766
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 0.036 
                | Test Acc: 0.9905 
                | Test Counting Acc: 0.9913 
                | Test Last Acc: 0.9271
                | Test Unseen Len Acc: 0.9702
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0195 
                | Test Acc: 0.9934 
                | Test Counting Acc: 0.994 
                | Test Last Acc: 0.9495
                | Test Unseen Len Acc: 0.9795
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.1204 
                | Test Acc: 0.9676 
                | Test Counting Acc: 0.9685 
                | Test Last Acc: 0.9465
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 0.3637 
                | Test Acc: 0.9296 
                | Test Counting Acc: 0.9301 
                | Test Last Acc: 0.8916
                | Test Unseen Len Acc: 0.8977
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0971 
                | Test Acc: 0.9745 
                | Test Counting Acc: 0.9762 
                | Test Last Acc: 0.8521
                | Test Unseen Len Acc: 0.9204
            
Finish!!! 0926_230957
