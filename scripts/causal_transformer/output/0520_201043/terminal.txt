------------- Preparing model -------------
Total parameters: 25204736
Trainable parameters: 25204736
------------- Preparing data -------------
max_seen_len for counting_selective_modular_4items = 64
num train = 1000000
num val = 2000
------------ Start job 0520_201043 ------------
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 1.7248 
                        | Val Acc: 0.2128 
                        | Val Counting Acc: 0.2128 
                        | Val Last Acc: 0.2095
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 1.6999
                            | Test Acc: 0.2086
                            | Test Counting Acc: 0.2089
                            | Test Last Acc: 0.1747
                            | Test Unseen Len Acc: 0.2066
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.1071 
                    | Val Acc: 0.9567 
                    | Val Counting Acc: 0.9588 
                    | Val Last Acc: 0.823
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.0689
                    | Test Acc: 0.697
                    | Test Counting Acc: 0.7003
                    | Test Last Acc: 0.2723
                    | Test Unseen Len Acc: 0.4531
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 0.0549 
                        | Val Acc: 0.9802 
                        | Val Counting Acc: 0.9814 
                        | Val Last Acc: 0.9035
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 1.2168
                            | Test Acc: 0.7025
                            | Test Counting Acc: 0.7062
                            | Test Last Acc: 0.2387
                            | Test Unseen Len Acc: 0.4122
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0431 
                    | Val Acc: 0.984 
                    | Val Counting Acc: 0.9849 
                    | Val Last Acc: 0.9255
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 1.5577
                    | Test Acc: 0.6817
                    | Test Counting Acc: 0.6852
                    | Test Last Acc: 0.2433
                    | Test Unseen Len Acc: 0.3879
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.0794 
                        | Val Acc: 0.9716 
                        | Val Counting Acc: 0.9728 
                        | Val Last Acc: 0.8965
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 1.8921
                            | Test Acc: 0.6622
                            | Test Counting Acc: 0.6653
                            | Test Last Acc: 0.266
                            | Test Unseen Len Acc: 0.3265
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.0336 
                    | Val Acc: 0.9881 
                    | Val Counting Acc: 0.9889 
                    | Val Last Acc: 0.9355
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 1.8697
                    | Test Acc: 0.6733
                    | Test Counting Acc: 0.6765
                    | Test Last Acc: 0.262
                    | Test Unseen Len Acc: 0.359
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 0.0255 
                        | Val Acc: 0.9899 
                        | Val Counting Acc: 0.9905 
                        | Val Last Acc: 0.95
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 2.1207
                            | Test Acc: 0.6532
                            | Test Counting Acc: 0.6564
                            | Test Last Acc: 0.2483
                            | Test Unseen Len Acc: 0.3187
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0391 
                    | Val Acc: 0.9863 
                    | Val Counting Acc: 0.9874 
                    | Val Last Acc: 0.913
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 2.0189
                    | Test Acc: 0.6856
                    | Test Counting Acc: 0.689
                    | Test Last Acc: 0.2603
                    | Test Unseen Len Acc: 0.3785
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0051 
                    | Val Acc: 0.9981 
                    | Val Counting Acc: 0.9983 
                    | Val Last Acc: 0.9845
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 2.5605
                    | Test Acc: 0.6548
                    | Test Counting Acc: 0.6583
                    | Test Last Acc: 0.202
                    | Test Unseen Len Acc: 0.3095
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.0282 
                        | Val Acc: 0.9903 
                        | Val Counting Acc: 0.9908 
                        | Val Last Acc: 0.9555
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 2.8967
                            | Test Acc: 0.6483
                            | Test Counting Acc: 0.6516
                            | Test Last Acc: 0.2357
                            | Test Unseen Len Acc: 0.297
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0222 
                    | Val Acc: 0.9924 
                    | Val Counting Acc: 0.9932 
                    | Val Last Acc: 0.943
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 2.8062
                    | Test Acc: 0.6466
                    | Test Counting Acc: 0.6498
                    | Test Last Acc: 0.2477
                    | Test Unseen Len Acc: 0.294
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 0.0109 
                        | Val Acc: 0.9955 
                        | Val Counting Acc: 0.9957 
                        | Val Last Acc: 0.9815
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 3.0331
                            | Test Acc: 0.6379
                            | Test Counting Acc: 0.641
                            | Test Last Acc: 0.249
                            | Test Unseen Len Acc: 0.2768
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.0073 
                    | Val Acc: 0.9974 
                    | Val Counting Acc: 0.9976 
                    | Val Last Acc: 0.985
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 3.158
                    | Test Acc: 0.6433
                    | Test Counting Acc: 0.6463
                    | Test Last Acc: 0.259
                    | Test Unseen Len Acc: 0.2869
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0148 
                        | Val Acc: 0.9953 
                        | Val Counting Acc: 0.9958 
                        | Val Last Acc: 0.9635
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 3.1023
                            | Test Acc: 0.6321
                            | Test Counting Acc: 0.635
                            | Test Last Acc: 0.27
                            | Test Unseen Len Acc: 0.2669
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.002 
                    | Val Acc: 0.9993 
                    | Val Counting Acc: 0.9993 
                    | Val Last Acc: 0.9945
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 2.7813
                    | Test Acc: 0.6472
                    | Test Counting Acc: 0.6503
                    | Test Last Acc: 0.2493
                    | Test Unseen Len Acc: 0.2944
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 0.0052 
                        | Val Acc: 0.9982 
                        | Val Counting Acc: 0.9983 
                        | Val Last Acc: 0.99
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 3.6381
                            | Test Acc: 0.6453
                            | Test Counting Acc: 0.6484
                            | Test Last Acc: 0.249
                            | Test Unseen Len Acc: 0.2911
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0137 
                    | Val Acc: 0.9953 
                    | Val Counting Acc: 0.9959 
                    | Val Last Acc: 0.961
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 3.4145
                    | Test Acc: 0.6499
                    | Test Counting Acc: 0.6531
                    | Test Last Acc: 0.2507
                    | Test Unseen Len Acc: 0.301
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0077 
                    | Val Acc: 0.9973 
                    | Val Counting Acc: 0.9976 
                    | Val Last Acc: 0.9805
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 3.6101
                    | Test Acc: 0.6364
                    | Test Counting Acc: 0.6393
                    | Test Last Acc: 0.267
                    | Test Unseen Len Acc: 0.2742


------------- Start Inference -------------


---------------------- 0520_201043 ----------------------
max_seen_len for counting_selective_modular_4items = 64
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.0996 
                | Test Acc: 0.9588 
                | Test Counting Acc: 0.9609 
                | Test Last Acc: 0.8249
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.0699 
                | Test Acc: 0.6964 
                | Test Counting Acc: 0.6997 
                | Test Last Acc: 0.2717
                | Test Unseen Len Acc: 0.4523
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0438 
                | Test Acc: 0.9833 
                | Test Counting Acc: 0.9842 
                | Test Last Acc: 0.9238
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 1.5595 
                | Test Acc: 0.6822 
                | Test Counting Acc: 0.6856 
                | Test Last Acc: 0.246
                | Test Unseen Len Acc: 0.3884
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0304 
                | Test Acc: 0.9892 
                | Test Counting Acc: 0.99 
                | Test Last Acc: 0.9404
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 1.8689 
                | Test Acc: 0.6731 
                | Test Counting Acc: 0.6762 
                | Test Last Acc: 0.2688
                | Test Unseen Len Acc: 0.3587
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0377 
                | Test Acc: 0.9865 
                | Test Counting Acc: 0.9877 
                | Test Last Acc: 0.9146
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 2.0196 
                | Test Acc: 0.6856 
                | Test Counting Acc: 0.6889 
                | Test Last Acc: 0.2607
                | Test Unseen Len Acc: 0.3785
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0052 
                | Test Acc: 0.9981 
                | Test Counting Acc: 0.9982 
                | Test Last Acc: 0.9875
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 2.5609 
                | Test Acc: 0.6542 
                | Test Counting Acc: 0.6578 
                | Test Last Acc: 0.2008
                | Test Unseen Len Acc: 0.3085
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0223 
                | Test Acc: 0.9927 
                | Test Counting Acc: 0.9935 
                | Test Last Acc: 0.9422
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 2.8077 
                | Test Acc: 0.6466 
                | Test Counting Acc: 0.6498 
                | Test Last Acc: 0.249
                | Test Unseen Len Acc: 0.2941
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0075 
                | Test Acc: 0.9974 
                | Test Counting Acc: 0.9975 
                | Test Last Acc: 0.987
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 3.1613 
                | Test Acc: 0.6428 
                | Test Counting Acc: 0.6459 
                | Test Last Acc: 0.255
                | Test Unseen Len Acc: 0.2862
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0019 
                | Test Acc: 0.9993 
                | Test Counting Acc: 0.9994 
                | Test Last Acc: 0.9928
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 2.7844 
                | Test Acc: 0.6474 
                | Test Counting Acc: 0.6505 
                | Test Last Acc: 0.2486
                | Test Unseen Len Acc: 0.2949
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.013 
                | Test Acc: 0.9955 
                | Test Counting Acc: 0.996 
                | Test Last Acc: 0.9623
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 3.4119 
                | Test Acc: 0.6501 
                | Test Counting Acc: 0.6532 
                | Test Last Acc: 0.2537
                | Test Unseen Len Acc: 0.3012
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0077 
                | Test Acc: 0.9972 
                | Test Counting Acc: 0.9976 
                | Test Last Acc: 0.9758
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 3.61 
                | Test Acc: 0.6363 
                | Test Counting Acc: 0.6392 
                | Test Last Acc: 0.2653
                | Test Unseen Len Acc: 0.2741
            
Finish!!! 0520_201043
