------------- Preparing model -------------
Total parameters: 12620789
------------- Preparing data -------------
max_seen_len for counting_selective_10items2 = 50
num train = 1000000
num val = 2000
------------ Start job 0427_004659 ------------
[2024-04-27 00:47:11,371] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 2.5728 
                        | Val Acc: 0.1303 
                        | Val Counting Acc: 0.1315 
                        | Val Last Acc: 0.0705
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 2.6155
                            | Test Acc: 0.1186
                            | Test Counting Acc: 0.1198
                            | Test Last Acc: 0.0281
                            | Test Unseen Len Acc: 0.0497
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.0583 
                    | Val Acc: 0.9838 
                    | Val Counting Acc: 0.9836 
                    | Val Last Acc: 0.9925
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 27.7683
                    | Test Acc: 0.2226
                    | Test Counting Acc: 0.2241
                    | Test Last Acc: 0.1114
                    | Test Unseen Len Acc: 0.0233
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 0.025 
                        | Val Acc: 0.9918 
                        | Val Counting Acc: 0.992 
                        | Val Last Acc: 0.983
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 29.6909
                            | Test Acc: 0.23
                            | Test Counting Acc: 0.2317
                            | Test Last Acc: 0.1101
                            | Test Unseen Len Acc: 0.0179
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0184 
                    | Val Acc: 0.9938 
                    | Val Counting Acc: 0.9941 
                    | Val Last Acc: 0.979
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 39.3832
                    | Test Acc: 0.2101
                    | Test Counting Acc: 0.2121
                    | Test Last Acc: 0.0602
                    | Test Unseen Len Acc: 0.0109
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.0059 
                        | Val Acc: 0.9986 
                        | Val Counting Acc: 0.9987 
                        | Val Last Acc: 0.996
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 41.8689
                            | Test Acc: 0.2246
                            | Test Counting Acc: 0.2264
                            | Test Last Acc: 0.0856
                            | Test Unseen Len Acc: 0.015
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.007 
                    | Val Acc: 0.998 
                    | Val Counting Acc: 0.998 
                    | Val Last Acc: 0.998
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 46.8864
                    | Test Acc: 0.2168
                    | Test Counting Acc: 0.2187
                    | Test Last Acc: 0.0773
                    | Test Unseen Len Acc: 0.0133
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 0.0006 
                        | Val Acc: 0.9998 
                        | Val Counting Acc: 0.9998 
                        | Val Last Acc: 0.9995
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 49.9365
                            | Test Acc: 0.2362
                            | Test Counting Acc: 0.238
                            | Test Last Acc: 0.1014
                            | Test Unseen Len Acc: 0.0206
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0148 
                    | Val Acc: 0.996 
                    | Val Counting Acc: 0.9962 
                    | Val Last Acc: 0.987
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 52.0514
                    | Test Acc: 0.2115
                    | Test Counting Acc: 0.2133
                    | Test Last Acc: 0.0803
                    | Test Unseen Len Acc: 0.0147
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0001 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 55.5445
                    | Test Acc: 0.2141
                    | Test Counting Acc: 0.2158
                    | Test Last Acc: 0.0867
                    | Test Unseen Len Acc: 0.0153
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.0032 
                        | Val Acc: 0.9978 
                        | Val Counting Acc: 0.9978 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 54.0749
                            | Test Acc: 0.2281
                            | Test Counting Acc: 0.23
                            | Test Last Acc: 0.0873
                            | Test Unseen Len Acc: 0.0161
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0002 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 0.9999 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 57.3203
                    | Test Acc: 0.212
                    | Test Counting Acc: 0.2137
                    | Test Last Acc: 0.086
                    | Test Unseen Len Acc: 0.0149
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 56.8795
                            | Test Acc: 0.2136
                            | Test Counting Acc: 0.2153
                            | Test Last Acc: 0.084
                            | Test Unseen Len Acc: 0.0138
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.0013 
                    | Val Acc: 0.9996 
                    | Val Counting Acc: 0.9997 
                    | Val Last Acc: 0.9955
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 58.043
                    | Test Acc: 0.2061
                    | Test Counting Acc: 0.2079
                    | Test Last Acc: 0.0733
                    | Test Unseen Len Acc: 0.012
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0043 
                        | Val Acc: 0.9986 
                        | Val Counting Acc: 0.9986 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 54.1044
                            | Test Acc: 0.2431
                            | Test Counting Acc: 0.2451
                            | Test Last Acc: 0.0953
                            | Test Unseen Len Acc: 0.0172
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 57.9395
                    | Test Acc: 0.211
                    | Test Counting Acc: 0.2127
                    | Test Last Acc: 0.0846
                    | Test Unseen Len Acc: 0.0142
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 57.8571
                            | Test Acc: 0.2164
                            | Test Counting Acc: 0.2181
                            | Test Last Acc: 0.087
                            | Test Unseen Len Acc: 0.0151
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 58.6901
                    | Test Acc: 0.2176
                    | Test Counting Acc: 0.2194
                    | Test Last Acc: 0.0846
                    | Test Unseen Len Acc: 0.0135
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0009 
                    | Val Acc: 0.9997 
                    | Val Counting Acc: 0.9997 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 58.4204
                    | Test Acc: 0.2139
                    | Test Counting Acc: 0.2157
                    | Test Last Acc: 0.0846
                    | Test Unseen Len Acc: 0.0153


------------- Start Inference -------------
Finish!!! 0427_004659
