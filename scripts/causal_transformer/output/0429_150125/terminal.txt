------------- Preparing model -------------
Total parameters: 12940288
------------- Preparing data -------------
max_seen_len for counting_samesymbol_shiftedstart3 = 51
num train = 1000000
num val = 50
------------ Start job 0429_150125 ------------
[2024-04-29 15:01:37,373] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
k = 50, last_demo = 50
Epoch 0 Step 0 
                        | Val Loss: 4.733 
                        | Val Acc: 0.0108 
                        | Val Counting Acc: 0.0106 
                        | Val Last Acc: 0.02
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 4.7599
                            | Test Acc: 0.0132
                            | Test Counting Acc: 0.0133
                            | Test Last Acc: 0.0065
                            | Test Unseen Len Acc: 0.0096
k = 50, last_demo = 50
Epoch 0 Step 31250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 2.6876
                    | Test Acc: 0.7988
                    | Test Counting Acc: 0.8077
                    | Test Last Acc: 0.2122
                    | Test Unseen Len Acc: 0.1601
k = 50, last_demo = 50
Epoch 1 Step 40000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 1.8182
                            | Test Acc: 0.821
                            | Test Counting Acc: 0.8298
                            | Test Last Acc: 0.24
                            | Test Unseen Len Acc: 0.2518
k = 50, last_demo = 50
Epoch 1 Step 62500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 2.6673
                    | Test Acc: 0.824
                    | Test Counting Acc: 0.8324
                    | Test Last Acc: 0.2702
                    | Test Unseen Len Acc: 0.264
k = 50, last_demo = 50
Epoch 2 Step 80000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 1.4887
                            | Test Acc: 0.8561
                            | Test Counting Acc: 0.8636
                            | Test Last Acc: 0.3584
                            | Test Unseen Len Acc: 0.3982
k = 50, last_demo = 50
Epoch 2 Step 93750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 1.4461
                    | Test Acc: 0.8724
                    | Test Counting Acc: 0.8798
                    | Test Last Acc: 0.3869
                    | Test Unseen Len Acc: 0.4666
k = 50, last_demo = 50
Epoch 3 Step 120000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 1.4399
                            | Test Acc: 0.8692
                            | Test Counting Acc: 0.8764
                            | Test Last Acc: 0.3927
                            | Test Unseen Len Acc: 0.4534
k = 50, last_demo = 50
Epoch 3 Step 125000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 1.4703
                    | Test Acc: 0.874
                    | Test Counting Acc: 0.8813
                    | Test Last Acc: 0.3918
                    | Test Unseen Len Acc: 0.4732
k = 50, last_demo = 50
Epoch 4 Step 156250 
                    | Val Loss: 0.0025 
                    | Val Acc: 0.9984 
                    | Val Counting Acc: 0.9988 
                    | Val Last Acc: 0.98
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 5.1392
                    | Test Acc: 0.875
                    | Test Counting Acc: 0.8825
                    | Test Last Acc: 0.3755
                    | Test Unseen Len Acc: 0.4826
k = 50, last_demo = 50
Epoch 5 Step 160000 
                        | Val Loss: 0.0006 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 5.8618
                            | Test Acc: 0.8708
                            | Test Counting Acc: 0.8779
                            | Test Last Acc: 0.4057
                            | Test Unseen Len Acc: 0.461
k = 50, last_demo = 50
Epoch 5 Step 187500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 6.1933
                    | Test Acc: 0.8628
                    | Test Counting Acc: 0.87
                    | Test Last Acc: 0.3845
                    | Test Unseen Len Acc: 0.4271
k = 50, last_demo = 50
Epoch 6 Step 200000 
                        | Val Loss: 0.0057 
                        | Val Acc: 0.9992 
                        | Val Counting Acc: 0.9992 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 6.7803
                            | Test Acc: 0.8618
                            | Test Counting Acc: 0.8691
                            | Test Last Acc: 0.382
                            | Test Unseen Len Acc: 0.4229
k = 50, last_demo = 50
Epoch 6 Step 218750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 6.1119
                    | Test Acc: 0.8632
                    | Test Counting Acc: 0.8704
                    | Test Last Acc: 0.3853
                    | Test Unseen Len Acc: 0.4278
k = 50, last_demo = 50
Epoch 7 Step 240000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 6.6887
                            | Test Acc: 0.859
                            | Test Counting Acc: 0.8662
                            | Test Last Acc: 0.3861
                            | Test Unseen Len Acc: 0.4105
k = 50, last_demo = 50
Epoch 7 Step 250000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 2.6302
                    | Test Acc: 0.8634
                    | Test Counting Acc: 0.8708
                    | Test Last Acc: 0.3763
                    | Test Unseen Len Acc: 0.4287
k = 50, last_demo = 50
Epoch 8 Step 280000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 1.9664
                            | Test Acc: 0.8801
                            | Test Counting Acc: 0.8874
                            | Test Last Acc: 0.3976
                            | Test Unseen Len Acc: 0.4996
k = 50, last_demo = 50
Epoch 8 Step 281250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 2.0031
                    | Test Acc: 0.8811
                    | Test Counting Acc: 0.8884
                    | Test Last Acc: 0.4
                    | Test Unseen Len Acc: 0.5045
k = 50, last_demo = 50
Epoch 9 Step 312500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 1.9246
                    | Test Acc: 0.8785
                    | Test Counting Acc: 0.8861
                    | Test Last Acc: 0.3771
                    | Test Unseen Len Acc: 0.4935


------------- Start Inference -------------
max_seen_len for counting_samesymbol_shiftedstart3 = 51
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 2.5523 
                | Test Acc: 0.7986 
                | Test Counting Acc: 0.8076 
                | Test Last Acc: 0.2026
                | Test Unseen Len Acc: 0.1585
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 2.5285 
                | Test Acc: 0.8244 
                | Test Counting Acc: 0.8324 
                | Test Last Acc: 0.2938
                | Test Unseen Len Acc: 0.2656
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 1.3657 
                | Test Acc: 0.8733 
                | Test Counting Acc: 0.8805 
                | Test Last Acc: 0.3956
                | Test Unseen Len Acc: 0.4701
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 1.405 
                | Test Acc: 0.8744 
                | Test Counting Acc: 0.8816 
                | Test Last Acc: 0.3976
                | Test Unseen Len Acc: 0.4749
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0037 
                | Test Acc: 0.9991 
                | Test Counting Acc: 0.9994 
                | Test Last Acc: 0.984
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 4.781 
                | Test Acc: 0.8749 
                | Test Counting Acc: 0.8822 
                | Test Last Acc: 0.3919
                | Test Unseen Len Acc: 0.4794
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 5.2985 
                | Test Acc: 0.8673 
                | Test Counting Acc: 0.8745 
                | Test Last Acc: 0.3866
                | Test Unseen Len Acc: 0.4454
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 5.692 
                | Test Acc: 0.8639 
                | Test Counting Acc: 0.8711 
                | Test Last Acc: 0.3857
                | Test Unseen Len Acc: 0.4307
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 2.5244 
                | Test Acc: 0.8605 
                | Test Counting Acc: 0.8678 
                | Test Last Acc: 0.3799
                | Test Unseen Len Acc: 0.4167
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 1.8887 
                | Test Acc: 0.8798 
                | Test Counting Acc: 0.8871 
                | Test Last Acc: 0.3962
                | Test Unseen Len Acc: 0.4984
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 1.8021 
                | Test Acc: 0.8802 
                | Test Counting Acc: 0.8875 
                | Test Last Acc: 0.3999
                | Test Unseen Len Acc: 0.5001
            
Finish!!! 0429_150125
