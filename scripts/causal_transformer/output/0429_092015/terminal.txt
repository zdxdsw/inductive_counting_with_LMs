------------- Preparing model -------------
Total parameters: 50597888
------------- Preparing data -------------
max_seen_len for counting_samesymbol_shiftedstart2_padhelper = 51
num train = 1000000
num val = 300
------------ Start job 0429_092015 ------------
[2024-04-29 09:20:27,279] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
k = 300, last_demo = 300
Epoch 0 Step 0 
                        | Val Loss: 4.8128 
                        | Val Acc: 0.0073 
                        | Val Counting Acc: 0.0067 
                        | Val Last Acc: 0.02
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 4.8179
                            | Test Acc: 0.0051
                            | Test Counting Acc: 0.0046
                            | Test Last Acc: 0.0351
                            | Test Unseen Len Acc: 0.0124
k = 300, last_demo = 300
Epoch 0 Step 31250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 0.3016
                    | Test Acc: 0.9449
                    | Test Counting Acc: 0.95
                    | Test Last Acc: 0.6033
                    | Test Unseen Len Acc: 0.7797
k = 300, last_demo = 300
Epoch 1 Step 40000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 0.2726
                            | Test Acc: 0.9465
                            | Test Counting Acc: 0.9516
                            | Test Last Acc: 0.6098
                            | Test Unseen Len Acc: 0.7861
k = 300, last_demo = 300
Epoch 1 Step 62500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 0.2477
                    | Test Acc: 0.9459
                    | Test Counting Acc: 0.9511
                    | Test Last Acc: 0.6024
                    | Test Unseen Len Acc: 0.7838
k = 300, last_demo = 300
Epoch 2 Step 80000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 0.2371
                            | Test Acc: 0.9432
                            | Test Counting Acc: 0.9484
                            | Test Last Acc: 0.5927
                            | Test Unseen Len Acc: 0.7727
k = 300, last_demo = 300
Epoch 2 Step 93750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 0.2378
                    | Test Acc: 0.9425
                    | Test Counting Acc: 0.9477
                    | Test Last Acc: 0.5951
                    | Test Unseen Len Acc: 0.7702
k = 300, last_demo = 300
Epoch 3 Step 120000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 0.9542
                            | Test Acc: 0.9238
                            | Test Counting Acc: 0.9273
                            | Test Last Acc: 0.6914
                            | Test Unseen Len Acc: 0.6952
k = 300, last_demo = 300
Epoch 3 Step 125000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 0.8321
                    | Test Acc: 0.9247
                    | Test Counting Acc: 0.9288
                    | Test Last Acc: 0.6522
                    | Test Unseen Len Acc: 0.6988
k = 300, last_demo = 300
Epoch 4 Step 156250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 0.7935
                    | Test Acc: 0.9388
                    | Test Counting Acc: 0.9408
                    | Test Last Acc: 0.8016
                    | Test Unseen Len Acc: 0.755
k = 300, last_demo = 300
Epoch 5 Step 160000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 0.6216
                            | Test Acc: 0.9427
                            | Test Counting Acc: 0.9447
                            | Test Last Acc: 0.8122
                            | Test Unseen Len Acc: 0.771
k = 300, last_demo = 300
Epoch 5 Step 187500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 0.868
                    | Test Acc: 0.9446
                    | Test Counting Acc: 0.9463
                    | Test Last Acc: 0.831
                    | Test Unseen Len Acc: 0.7786
k = 300, last_demo = 300
Epoch 6 Step 200000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 0.4256
                            | Test Acc: 0.9345
                            | Test Counting Acc: 0.9375
                            | Test Last Acc: 0.7322
                            | Test Unseen Len Acc: 0.7381
k = 300, last_demo = 300
Epoch 6 Step 218750 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 0.3132
                    | Test Acc: 0.9696
                    | Test Counting Acc: 0.971
                    | Test Last Acc: 0.8759
                    | Test Unseen Len Acc: 0.8785
k = 300, last_demo = 300
Epoch 7 Step 240000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 0.3923
                            | Test Acc: 0.9539
                            | Test Counting Acc: 0.9561
                            | Test Last Acc: 0.8098
                            | Test Unseen Len Acc: 0.8157
k = 300, last_demo = 300
Epoch 7 Step 250000 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 1.1308
                    | Test Acc: 0.9424
                    | Test Counting Acc: 0.9447
                    | Test Last Acc: 0.7894
                    | Test Unseen Len Acc: 0.7696
k = 300, last_demo = 300
Epoch 8 Step 280000 
                        | Val Loss: 0.0 
                        | Val Acc: 1.0 
                        | Val Counting Acc: 1.0 
                        | Val Last Acc: 1.0
                        | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 0.9501
                            | Test Acc: 0.9575
                            | Test Counting Acc: 0.9593
                            | Test Last Acc: 0.8335
                            | Test Unseen Len Acc: 0.8299
k = 300, last_demo = 300
Epoch 8 Step 281250 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 0.9115
                    | Test Acc: 0.9588
                    | Test Counting Acc: 0.9607
                    | Test Last Acc: 0.8351
                    | Test Unseen Len Acc: 0.8353
k = 300, last_demo = 300
Epoch 9 Step 312500 
                    | Val Loss: 0.0 
                    | Val Acc: 1.0 
                    | Val Counting Acc: 1.0 
                    | Val Last Acc: 1.0
                    | Val Unseen Len Acc: -1
k = 1225, last_demo = 1225
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 0.4254
                    | Test Acc: 0.964
                    | Test Counting Acc: 0.9654
                    | Test Last Acc: 0.8702
                    | Test Unseen Len Acc: 0.8559


------------- Start Inference -------------
max_seen_len for counting_samesymbol_shiftedstart2_padhelper = 51
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 0.2687 
                | Test Acc: 0.945 
                | Test Counting Acc: 0.95 
                | Test Last Acc: 0.6041
                | Test Unseen Len Acc: 0.7798
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 0.2141 
                | Test Acc: 0.9497 
                | Test Counting Acc: 0.9545 
                | Test Last Acc: 0.6278
                | Test Unseen Len Acc: 0.7989
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 0.1887 
                | Test Acc: 0.9504 
                | Test Counting Acc: 0.9549 
                | Test Last Acc: 0.649
                | Test Unseen Len Acc: 0.8015
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 0.7227 
                | Test Acc: 0.9235 
                | Test Counting Acc: 0.9273 
                | Test Last Acc: 0.6743
                | Test Unseen Len Acc: 0.6942
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 0.7215 
                | Test Acc: 0.9338 
                | Test Counting Acc: 0.9359 
                | Test Last Acc: 0.7927
                | Test Unseen Len Acc: 0.7352
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 0.7807 
                | Test Acc: 0.9456 
                | Test Counting Acc: 0.9473 
                | Test Last Acc: 0.8351
                | Test Unseen Len Acc: 0.7824
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 0.2716 
                | Test Acc: 0.9651 
                | Test Counting Acc: 0.9665 
                | Test Last Acc: 0.8678
                | Test Unseen Len Acc: 0.8603
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 0.9832 
                | Test Acc: 0.9396 
                | Test Counting Acc: 0.9418 
                | Test Last Acc: 0.7878
                | Test Unseen Len Acc: 0.7583
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 0.7691 
                | Test Acc: 0.957 
                | Test Counting Acc: 0.9589 
                | Test Last Acc: 0.8335
                | Test Unseen Len Acc: 0.8281
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0 
                | Test Acc: 1.0 
                | Test Counting Acc: 1.0 
                | Test Last Acc: 1.0
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 0.3648 
                | Test Acc: 0.9644 
                | Test Counting Acc: 0.9658 
                | Test Last Acc: 0.8751
                | Test Unseen Len Acc: 0.8578
            
Finish!!! 0429_092015
