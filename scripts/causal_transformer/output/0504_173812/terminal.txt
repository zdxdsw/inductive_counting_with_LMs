------------- Preparing model -------------
Total parameters: 25337856
------------- Preparing data -------------
max_seen_len for counting_selective_modular_4items = 64
num train = 1000000
num val = 2000
------------ Start job 0504_173812 ------------
[2024-05-04 17:38:23,114] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 1.7939 
                        | Val Acc: 0.1894 
                        | Val Counting Acc: 0.1897 
                        | Val Last Acc: 0.1725
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 1.7634
                            | Test Acc: 0.2071
                            | Test Counting Acc: 0.2073
                            | Test Last Acc: 0.1873
                            | Test Unseen Len Acc: 0.1969
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.2148 
                    | Val Acc: 0.9109 
                    | Val Counting Acc: 0.9144 
                    | Val Last Acc: 0.6875
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.1341
                    | Test Acc: 0.6345
                    | Test Counting Acc: 0.6374
                    | Test Last Acc: 0.2653
                    | Test Unseen Len Acc: 0.3234
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 0.1441 
                        | Val Acc: 0.9392 
                        | Val Counting Acc: 0.9421 
                        | Val Last Acc: 0.758
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 1.4625
                            | Test Acc: 0.6283
                            | Test Counting Acc: 0.6315
                            | Test Last Acc: 0.2263
                            | Test Unseen Len Acc: 0.2867
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0749 
                    | Val Acc: 0.9707 
                    | Val Counting Acc: 0.9723 
                    | Val Last Acc: 0.8685
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 1.735
                    | Test Acc: 0.6433
                    | Test Counting Acc: 0.6463
                    | Test Last Acc: 0.2643
                    | Test Unseen Len Acc: 0.298
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.0464 
                        | Val Acc: 0.9815 
                        | Val Counting Acc: 0.9824 
                        | Val Last Acc: 0.9245
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 1.933
                            | Test Acc: 0.6406
                            | Test Counting Acc: 0.6437
                            | Test Last Acc: 0.248
                            | Test Unseen Len Acc: 0.2877
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.0315 
                    | Val Acc: 0.9879 
                    | Val Counting Acc: 0.9887 
                    | Val Last Acc: 0.935
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 2.182
                    | Test Acc: 0.6276
                    | Test Counting Acc: 0.6306
                    | Test Last Acc: 0.2463
                    | Test Unseen Len Acc: 0.2677
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 0.0639 
                        | Val Acc: 0.9765 
                        | Val Counting Acc: 0.9775 
                        | Val Last Acc: 0.9145
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 2.3075
                            | Test Acc: 0.6355
                            | Test Counting Acc: 0.6386
                            | Test Last Acc: 0.2433
                            | Test Unseen Len Acc: 0.2778
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0191 
                    | Val Acc: 0.9926 
                    | Val Counting Acc: 0.9931 
                    | Val Last Acc: 0.9635
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 2.5216
                    | Test Acc: 0.6335
                    | Test Counting Acc: 0.6366
                    | Test Last Acc: 0.2487
                    | Test Unseen Len Acc: 0.2739
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0117 
                    | Val Acc: 0.9961 
                    | Val Counting Acc: 0.9963 
                    | Val Last Acc: 0.982
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 2.6819
                    | Test Acc: 0.6389
                    | Test Counting Acc: 0.6421
                    | Test Last Acc: 0.2353
                    | Test Unseen Len Acc: 0.282
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.027 
                        | Val Acc: 0.9908 
                        | Val Counting Acc: 0.9914 
                        | Val Last Acc: 0.9565
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 2.8015
                            | Test Acc: 0.6403
                            | Test Counting Acc: 0.6435
                            | Test Last Acc: 0.239
                            | Test Unseen Len Acc: 0.2824
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0103 
                    | Val Acc: 0.9963 
                    | Val Counting Acc: 0.9966 
                    | Val Last Acc: 0.9785
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 2.8197
                    | Test Acc: 0.6359
                    | Test Counting Acc: 0.639
                    | Test Last Acc: 0.251
                    | Test Unseen Len Acc: 0.2724
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 0.0054 
                        | Val Acc: 0.9981 
                        | Val Counting Acc: 0.9983 
                        | Val Last Acc: 0.986
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 2.9104
                            | Test Acc: 0.6384
                            | Test Counting Acc: 0.6415
                            | Test Last Acc: 0.2403
                            | Test Unseen Len Acc: 0.2772
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.0086 
                    | Val Acc: 0.9971 
                    | Val Counting Acc: 0.9973 
                    | Val Last Acc: 0.984
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 3.1781
                    | Test Acc: 0.6348
                    | Test Counting Acc: 0.6378
                    | Test Last Acc: 0.2493
                    | Test Unseen Len Acc: 0.2717
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0101 
                        | Val Acc: 0.9965 
                        | Val Counting Acc: 0.9967 
                        | Val Last Acc: 0.9835
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 3.4803
                            | Test Acc: 0.6404
                            | Test Counting Acc: 0.6435
                            | Test Last Acc: 0.2427
                            | Test Unseen Len Acc: 0.2813
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.0126 
                    | Val Acc: 0.9956 
                    | Val Counting Acc: 0.9958 
                    | Val Last Acc: 0.9845
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 3.9542
                    | Test Acc: 0.6373
                    | Test Counting Acc: 0.6404
                    | Test Last Acc: 0.2463
                    | Test Unseen Len Acc: 0.2747
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 0.0203 
                        | Val Acc: 0.9923 
                        | Val Counting Acc: 0.9926 
                        | Val Last Acc: 0.9725
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 3.9664
                            | Test Acc: 0.6327
                            | Test Counting Acc: 0.6358
                            | Test Last Acc: 0.2403
                            | Test Unseen Len Acc: 0.278
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0474 
                    | Val Acc: 0.9838 
                    | Val Counting Acc: 0.9844 
                    | Val Last Acc: 0.947
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 4.2182
                    | Test Acc: 0.6334
                    | Test Counting Acc: 0.6365
                    | Test Last Acc: 0.2463
                    | Test Unseen Len Acc: 0.2812
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0081 
                    | Val Acc: 0.9975 
                    | Val Counting Acc: 0.9975 
                    | Val Last Acc: 0.996
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 3.7313
                    | Test Acc: 0.6264
                    | Test Counting Acc: 0.6294
                    | Test Last Acc: 0.244
                    | Test Unseen Len Acc: 0.2724


------------- Start Inference -------------
max_seen_len for counting_selective_modular_4items = 64
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.215 
                | Test Acc: 0.9097 
                | Test Counting Acc: 0.9132 
                | Test Last Acc: 0.6882
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.1347 
                | Test Acc: 0.6342 
                | Test Counting Acc: 0.6371 
                | Test Last Acc: 0.2642
                | Test Unseen Len Acc: 0.3233
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0729 
                | Test Acc: 0.9716 
                | Test Counting Acc: 0.9731 
                | Test Last Acc: 0.8733
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 1.7332 
                | Test Acc: 0.6432 
                | Test Counting Acc: 0.6462 
                | Test Last Acc: 0.2653
                | Test Unseen Len Acc: 0.2977
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0332 
                | Test Acc: 0.9875 
                | Test Counting Acc: 0.9884 
                | Test Last Acc: 0.931
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 2.1831 
                | Test Acc: 0.6277 
                | Test Counting Acc: 0.6308 
                | Test Last Acc: 0.2448
                | Test Unseen Len Acc: 0.2677
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0195 
                | Test Acc: 0.9926 
                | Test Counting Acc: 0.993 
                | Test Last Acc: 0.9628
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 2.5225 
                | Test Acc: 0.6338 
                | Test Counting Acc: 0.6368 
                | Test Last Acc: 0.25
                | Test Unseen Len Acc: 0.2742
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0104 
                | Test Acc: 0.9963 
                | Test Counting Acc: 0.9966 
                | Test Last Acc: 0.9824
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 2.6806 
                | Test Acc: 0.6389 
                | Test Counting Acc: 0.642 
                | Test Last Acc: 0.2388
                | Test Unseen Len Acc: 0.282
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0104 
                | Test Acc: 0.9962 
                | Test Counting Acc: 0.9966 
                | Test Last Acc: 0.9748
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 2.8169 
                | Test Acc: 0.6357 
                | Test Counting Acc: 0.6387 
                | Test Last Acc: 0.2531
                | Test Unseen Len Acc: 0.2718
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0077 
                | Test Acc: 0.9973 
                | Test Counting Acc: 0.9975 
                | Test Last Acc: 0.983
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 3.1819 
                | Test Acc: 0.635 
                | Test Counting Acc: 0.6381 
                | Test Last Acc: 0.2449
                | Test Unseen Len Acc: 0.2723
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0136 
                | Test Acc: 0.9952 
                | Test Counting Acc: 0.9953 
                | Test Last Acc: 0.9838
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 3.9521 
                | Test Acc: 0.6374 
                | Test Counting Acc: 0.6405 
                | Test Last Acc: 0.2458
                | Test Unseen Len Acc: 0.2748
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.049 
                | Test Acc: 0.9838 
                | Test Counting Acc: 0.9844 
                | Test Last Acc: 0.945
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 4.2156 
                | Test Acc: 0.6333 
                | Test Counting Acc: 0.6364 
                | Test Last Acc: 0.2451
                | Test Unseen Len Acc: 0.2809
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0062 
                | Test Acc: 0.9979 
                | Test Counting Acc: 0.998 
                | Test Last Acc: 0.9964
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 3.7292 
                | Test Acc: 0.6264 
                | Test Counting Acc: 0.6294 
                | Test Last Acc: 0.2461
                | Test Unseen Len Acc: 0.2723
            
Finish!!! 0504_173812
