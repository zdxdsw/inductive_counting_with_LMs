------------- Preparing model -------------
Total parameters: 25217024
------------- Preparing data -------------
max_seen_len for counting_selective_10items = 50
num train = 1000000
num val = 2000
------------ Start job 0425_180856 ------------
[2024-04-25 18:10:02,264] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 2.9671 
                        | Val Acc: 0.0155 
                        | Val Counting Acc: 0.0148 
                        | Val Last Acc: 0.035
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 2.7876
                            | Test Acc: 0.0356
                            | Test Counting Acc: 0.0334
                            | Test Last Acc: 0.2041
                            | Test Unseen Len Acc: 0.0854
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.0522 
                    | Val Acc: 0.9839 
                    | Val Counting Acc: 0.9843 
                    | Val Last Acc: 0.973
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.9854
                    | Test Acc: 0.7452
                    | Test Counting Acc: 0.7534
                    | Test Last Acc: 0.1402
                    | Test Unseen Len Acc: 0.2673
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 0.0258 
                        | Val Acc: 0.9926 
                        | Val Counting Acc: 0.9926 
                        | Val Last Acc: 0.993
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 2.1989
                            | Test Acc: 0.7506
                            | Test Counting Acc: 0.7589
                            | Test Last Acc: 0.1332
                            | Test Unseen Len Acc: 0.257
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0248 
                    | Val Acc: 0.9928 
                    | Val Counting Acc: 0.9928 
                    | Val Last Acc: 0.993
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 2.2315
                    | Test Acc: 0.7586
                    | Test Counting Acc: 0.7669
                    | Test Last Acc: 0.1429
                    | Test Unseen Len Acc: 0.2805
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.027 
                        | Val Acc: 0.992 
                        | Val Counting Acc: 0.9921 
                        | Val Last Acc: 0.988
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 2.5271
                            | Test Acc: 0.7656
                            | Test Counting Acc: 0.7738
                            | Test Last Acc: 0.1593
                            | Test Unseen Len Acc: 0.3023
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.024 
                    | Val Acc: 0.993 
                    | Val Counting Acc: 0.9929 
                    | Val Last Acc: 0.9945
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 2.3551
                    | Test Acc: 0.7722
                    | Test Counting Acc: 0.7803
                    | Test Last Acc: 0.173
                    | Test Unseen Len Acc: 0.3214
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 0.0238 
                        | Val Acc: 0.993 
                        | Val Counting Acc: 0.993 
                        | Val Last Acc: 0.9935
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 2.0264
                            | Test Acc: 0.788
                            | Test Counting Acc: 0.7959
                            | Test Last Acc: 0.2058
                            | Test Unseen Len Acc: 0.3692
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0236 
                    | Val Acc: 0.9931 
                    | Val Counting Acc: 0.9931 
                    | Val Last Acc: 0.9945
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 2.2692
                    | Test Acc: 0.7801
                    | Test Counting Acc: 0.7881
                    | Test Last Acc: 0.1874
                    | Test Unseen Len Acc: 0.3444
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0695 
                    | Val Acc: 0.9817 
                    | Val Counting Acc: 0.9822 
                    | Val Last Acc: 0.9695
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 1.8529
                    | Test Acc: 0.7731
                    | Test Counting Acc: 0.7807
                    | Test Last Acc: 0.2111
                    | Test Unseen Len Acc: 0.3605
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.0235 
                        | Val Acc: 0.9932 
                        | Val Counting Acc: 0.9931 
                        | Val Last Acc: 0.9955
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 1.9919
                            | Test Acc: 0.7766
                            | Test Counting Acc: 0.7845
                            | Test Last Acc: 0.1907
                            | Test Unseen Len Acc: 0.334
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0456 
                    | Val Acc: 0.9878 
                    | Val Counting Acc: 0.988 
                    | Val Last Acc: 0.983
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 1.94
                    | Test Acc: 0.7866
                    | Test Counting Acc: 0.7946
                    | Test Last Acc: 0.194
                    | Test Unseen Len Acc: 0.3656
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 0.0232 
                        | Val Acc: 0.9932 
                        | Val Counting Acc: 0.9931 
                        | Val Last Acc: 0.9955
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 1.756
                            | Test Acc: 0.7953
                            | Test Counting Acc: 0.8031
                            | Test Last Acc: 0.2178
                            | Test Unseen Len Acc: 0.3899
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.024 
                    | Val Acc: 0.9929 
                    | Val Counting Acc: 0.9928 
                    | Val Last Acc: 0.995
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 1.8104
                    | Test Acc: 0.8037
                    | Test Counting Acc: 0.8114
                    | Test Last Acc: 0.2312
                    | Test Unseen Len Acc: 0.4153
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.026 
                        | Val Acc: 0.9923 
                        | Val Counting Acc: 0.9923 
                        | Val Last Acc: 0.992
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 1.7796
                            | Test Acc: 0.7762
                            | Test Counting Acc: 0.7842
                            | Test Last Acc: 0.1793
                            | Test Unseen Len Acc: 0.3337
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.0233 
                    | Val Acc: 0.9932 
                    | Val Counting Acc: 0.9931 
                    | Val Last Acc: 0.9955
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 1.7698
                    | Test Acc: 0.7914
                    | Test Counting Acc: 0.7993
                    | Test Last Acc: 0.2064
                    | Test Unseen Len Acc: 0.3785
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 0.0233 
                        | Val Acc: 0.9932 
                        | Val Counting Acc: 0.9931 
                        | Val Last Acc: 0.995
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 2.2365
                            | Test Acc: 0.7836
                            | Test Counting Acc: 0.7917
                            | Test Last Acc: 0.1823
                            | Test Unseen Len Acc: 0.3548
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0237 
                    | Val Acc: 0.993 
                    | Val Counting Acc: 0.993 
                    | Val Last Acc: 0.9945
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 1.9541
                    | Test Acc: 0.7853
                    | Test Counting Acc: 0.7932
                    | Test Last Acc: 0.1974
                    | Test Unseen Len Acc: 0.3603
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0242 
                    | Val Acc: 0.9929 
                    | Val Counting Acc: 0.9929 
                    | Val Last Acc: 0.9935
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 2.4259
                    | Test Acc: 0.7717
                    | Test Counting Acc: 0.7798
                    | Test Last Acc: 0.172
                    | Test Unseen Len Acc: 0.3196


------------- Start Inference -------------
max_seen_len for counting_selective_10items = 50
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.0522 
                | Test Acc: 0.9838 
                | Test Counting Acc: 0.9842 
                | Test Last Acc: 0.9735
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.9694 
                | Test Acc: 0.7451 
                | Test Counting Acc: 0.7533 
                | Test Last Acc: 0.1402
                | Test Unseen Len Acc: 0.2672
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0262 
                | Test Acc: 0.9928 
                | Test Counting Acc: 0.9928 
                | Test Last Acc: 0.993
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 2.2131 
                | Test Acc: 0.7586 
                | Test Counting Acc: 0.767 
                | Test Last Acc: 0.1429
                | Test Unseen Len Acc: 0.2805
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0255 
                | Test Acc: 0.993 
                | Test Counting Acc: 0.9929 
                | Test Last Acc: 0.9945
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 2.3348 
                | Test Acc: 0.7722 
                | Test Counting Acc: 0.7803 
                | Test Last Acc: 0.173
                | Test Unseen Len Acc: 0.3214
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0251 
                | Test Acc: 0.9931 
                | Test Counting Acc: 0.9931 
                | Test Last Acc: 0.9945
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 2.2499 
                | Test Acc: 0.7801 
                | Test Counting Acc: 0.7881 
                | Test Last Acc: 0.187
                | Test Unseen Len Acc: 0.3445
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0696 
                | Test Acc: 0.9818 
                | Test Counting Acc: 0.9823 
                | Test Last Acc: 0.9695
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 1.8375 
                | Test Acc: 0.7731 
                | Test Counting Acc: 0.7808 
                | Test Last Acc: 0.2104
                | Test Unseen Len Acc: 0.3607
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0476 
                | Test Acc: 0.9878 
                | Test Counting Acc: 0.988 
                | Test Last Acc: 0.983
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 1.9229 
                | Test Acc: 0.7867 
                | Test Counting Acc: 0.7947 
                | Test Last Acc: 0.1937
                | Test Unseen Len Acc: 0.3657
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0257 
                | Test Acc: 0.9929 
                | Test Counting Acc: 0.9928 
                | Test Last Acc: 0.995
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 1.7939 
                | Test Acc: 0.8037 
                | Test Counting Acc: 0.8115 
                | Test Last Acc: 0.2305
                | Test Unseen Len Acc: 0.4154
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0248 
                | Test Acc: 0.9932 
                | Test Counting Acc: 0.9931 
                | Test Last Acc: 0.9955
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 1.7541 
                | Test Acc: 0.7914 
                | Test Counting Acc: 0.7993 
                | Test Last Acc: 0.2071
                | Test Unseen Len Acc: 0.3783
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.0252 
                | Test Acc: 0.993 
                | Test Counting Acc: 0.993 
                | Test Last Acc: 0.9945
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 1.9364 
                | Test Acc: 0.7853 
                | Test Counting Acc: 0.7933 
                | Test Last Acc: 0.1974
                | Test Unseen Len Acc: 0.3605
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0258 
                | Test Acc: 0.9929 
                | Test Counting Acc: 0.9929 
                | Test Last Acc: 0.9935
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 2.4054 
                | Test Acc: 0.7717 
                | Test Counting Acc: 0.7798 
                | Test Last Acc: 0.172
                | Test Unseen Len Acc: 0.3197
            
Finish!!! 0425_180856
