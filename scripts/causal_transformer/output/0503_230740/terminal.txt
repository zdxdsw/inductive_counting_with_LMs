------------- Preparing model -------------
Total parameters: 25337856
------------- Preparing data -------------
max_seen_len for counting_selective_modular_4items = 64
num train = 1000000
num val = 2000
------------ Start job 0503_230740 ------------
[2024-05-03 23:07:50,953] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 1.6661 
                        | Val Acc: 0.2548 
                        | Val Counting Acc: 0.2546 
                        | Val Last Acc: 0.2655
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 1.6709
                            | Test Acc: 0.2524
                            | Test Counting Acc: 0.2525
                            | Test Last Acc: 0.243
                            | Test Unseen Len Acc: 0.2496
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.1391 
                    | Val Acc: 0.9453 
                    | Val Counting Acc: 0.9473 
                    | Val Last Acc: 0.816
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.805
                    | Test Acc: 0.6106
                    | Test Counting Acc: 0.6134
                    | Test Last Acc: 0.263
                    | Test Unseen Len Acc: 0.2647
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 0.1229 
                        | Val Acc: 0.9527 
                        | Val Counting Acc: 0.9549 
                        | Val Last Acc: 0.812
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 2.2414
                            | Test Acc: 0.6066
                            | Test Counting Acc: 0.6093
                            | Test Last Acc: 0.2607
                            | Test Unseen Len Acc: 0.2607
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0367 
                    | Val Acc: 0.9871 
                    | Val Counting Acc: 0.9876 
                    | Val Last Acc: 0.956
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 3.2157
                    | Test Acc: 0.6231
                    | Test Counting Acc: 0.6261
                    | Test Last Acc: 0.2477
                    | Test Unseen Len Acc: 0.2508
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.1099 
                        | Val Acc: 0.9599 
                        | Val Counting Acc: 0.9607 
                        | Val Last Acc: 0.9095
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 3.3901
                            | Test Acc: 0.5949
                            | Test Counting Acc: 0.5977
                            | Test Last Acc: 0.24
                            | Test Unseen Len Acc: 0.2519
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.0259 
                    | Val Acc: 0.9902 
                    | Val Counting Acc: 0.9909 
                    | Val Last Acc: 0.947
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 3.6267
                    | Test Acc: 0.625
                    | Test Counting Acc: 0.6281
                    | Test Last Acc: 0.2373
                    | Test Unseen Len Acc: 0.2534
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 0.0327 
                        | Val Acc: 0.9871 
                        | Val Counting Acc: 0.9875 
                        | Val Last Acc: 0.964
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 4.0093
                            | Test Acc: 0.6232
                            | Test Counting Acc: 0.6261
                            | Test Last Acc: 0.258
                            | Test Unseen Len Acc: 0.2482
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.0309 
                    | Val Acc: 0.9921 
                    | Val Counting Acc: 0.9922 
                    | Val Last Acc: 0.985
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 4.4293
                    | Test Acc: 0.6091
                    | Test Counting Acc: 0.6119
                    | Test Last Acc: 0.2473
                    | Test Unseen Len Acc: 0.2481
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.0211 
                    | Val Acc: 0.9927 
                    | Val Counting Acc: 0.993 
                    | Val Last Acc: 0.9775
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 4.412
                    | Test Acc: 0.6227
                    | Test Counting Acc: 0.6257
                    | Test Last Acc: 0.241
                    | Test Unseen Len Acc: 0.2458
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.0216 
                        | Val Acc: 0.9925 
                        | Val Counting Acc: 0.993 
                        | Val Last Acc: 0.965
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 4.3283
                            | Test Acc: 0.6245
                            | Test Counting Acc: 0.6275
                            | Test Last Acc: 0.2487
                            | Test Unseen Len Acc: 0.2497
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0186 
                    | Val Acc: 0.9938 
                    | Val Counting Acc: 0.9941 
                    | Val Last Acc: 0.974
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 4.779
                    | Test Acc: 0.6208
                    | Test Counting Acc: 0.6238
                    | Test Last Acc: 0.2423
                    | Test Unseen Len Acc: 0.2462
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 0.0166 
                        | Val Acc: 0.9945 
                        | Val Counting Acc: 0.9947 
                        | Val Last Acc: 0.985
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 4.9844
                            | Test Acc: 0.6247
                            | Test Counting Acc: 0.6277
                            | Test Last Acc: 0.2433
                            | Test Unseen Len Acc: 0.2504
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.0066 
                    | Val Acc: 0.9973 
                    | Val Counting Acc: 0.9975 
                    | Val Last Acc: 0.987
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 4.7885
                    | Test Acc: 0.6234
                    | Test Counting Acc: 0.6264
                    | Test Last Acc: 0.24
                    | Test Unseen Len Acc: 0.2468
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0142 
                        | Val Acc: 0.9956 
                        | Val Counting Acc: 0.9957 
                        | Val Last Acc: 0.9895
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 5.0904
                            | Test Acc: 0.624
                            | Test Counting Acc: 0.6271
                            | Test Last Acc: 0.2407
                            | Test Unseen Len Acc: 0.2484
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.0079 
                    | Val Acc: 0.9973 
                    | Val Counting Acc: 0.9977 
                    | Val Last Acc: 0.9695
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 5.1102
                    | Test Acc: 0.6244
                    | Test Counting Acc: 0.6273
                    | Test Last Acc: 0.2473
                    | Test Unseen Len Acc: 0.2497
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 0.0143 
                        | Val Acc: 0.9949 
                        | Val Counting Acc: 0.9949 
                        | Val Last Acc: 0.9915
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 5.694
                            | Test Acc: 0.6232
                            | Test Counting Acc: 0.6261
                            | Test Last Acc: 0.2567
                            | Test Unseen Len Acc: 0.2475
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0114 
                    | Val Acc: 0.9957 
                    | Val Counting Acc: 0.9959 
                    | Val Last Acc: 0.9855
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 5.5023
                    | Test Acc: 0.6215
                    | Test Counting Acc: 0.6241
                    | Test Last Acc: 0.2817
                    | Test Unseen Len Acc: 0.2432
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0084 
                    | Val Acc: 0.9969 
                    | Val Counting Acc: 0.997 
                    | Val Last Acc: 0.9895
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 5.8342
                    | Test Acc: 0.6249
                    | Test Counting Acc: 0.6277
                    | Test Last Acc: 0.2623
                    | Test Unseen Len Acc: 0.2498


------------- Start Inference -------------
max_seen_len for counting_selective_modular_4items = 64
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.1376 
                | Test Acc: 0.9466 
                | Test Counting Acc: 0.9487 
                | Test Last Acc: 0.8121
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.804 
                | Test Acc: 0.6114 
                | Test Counting Acc: 0.6142 
                | Test Last Acc: 0.2593
                | Test Unseen Len Acc: 0.2653
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0373 
                | Test Acc: 0.9867 
                | Test Counting Acc: 0.9872 
                | Test Last Acc: 0.9568
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 3.2152 
                | Test Acc: 0.6233 
                | Test Counting Acc: 0.6263 
                | Test Last Acc: 0.2437
                | Test Unseen Len Acc: 0.2508
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0265 
                | Test Acc: 0.9899 
                | Test Counting Acc: 0.9906 
                | Test Last Acc: 0.9466
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 3.6268 
                | Test Acc: 0.6253 
                | Test Counting Acc: 0.6283 
                | Test Last Acc: 0.2376
                | Test Unseen Len Acc: 0.2538
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0295 
                | Test Acc: 0.9922 
                | Test Counting Acc: 0.9923 
                | Test Last Acc: 0.9848
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 4.427 
                | Test Acc: 0.6091 
                | Test Counting Acc: 0.6119 
                | Test Last Acc: 0.249
                | Test Unseen Len Acc: 0.2482
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.0194 
                | Test Acc: 0.9933 
                | Test Counting Acc: 0.9935 
                | Test Last Acc: 0.9798
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 4.414 
                | Test Acc: 0.6227 
                | Test Counting Acc: 0.6257 
                | Test Last Acc: 0.2453
                | Test Unseen Len Acc: 0.2458
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0205 
                | Test Acc: 0.9932 
                | Test Counting Acc: 0.9935 
                | Test Last Acc: 0.9744
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 4.7819 
                | Test Acc: 0.6209 
                | Test Counting Acc: 0.6238 
                | Test Last Acc: 0.242
                | Test Unseen Len Acc: 0.2464
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0068 
                | Test Acc: 0.9973 
                | Test Counting Acc: 0.9975 
                | Test Last Acc: 0.9893
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 4.7889 
                | Test Acc: 0.6234 
                | Test Counting Acc: 0.6264 
                | Test Last Acc: 0.2434
                | Test Unseen Len Acc: 0.2469
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.0069 
                | Test Acc: 0.9976 
                | Test Counting Acc: 0.998 
                | Test Last Acc: 0.9732
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 5.1133 
                | Test Acc: 0.6244 
                | Test Counting Acc: 0.6274 
                | Test Last Acc: 0.2477
                | Test Unseen Len Acc: 0.2497
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.0119 
                | Test Acc: 0.996 
                | Test Counting Acc: 0.9961 
                | Test Last Acc: 0.9856
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 5.5035 
                | Test Acc: 0.6215 
                | Test Counting Acc: 0.6242 
                | Test Last Acc: 0.2788
                | Test Unseen Len Acc: 0.2433
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.0092 
                | Test Acc: 0.9968 
                | Test Counting Acc: 0.9969 
                | Test Last Acc: 0.9909
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 5.8356 
                | Test Acc: 0.6248 
                | Test Counting Acc: 0.6277 
                | Test Last Acc: 0.2631
                | Test Unseen Len Acc: 0.2497
            
Finish!!! 0503_230740
