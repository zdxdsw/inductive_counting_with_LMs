------------- Preparing model -------------
Total parameters: 25204736
Trainable parameters: 25204736
------------- Preparing data -------------
max_seen_len for counting_selective_modular_4items = 64
num train = 1000000
num val = 2000
------------ Start job 0520_200112 ------------
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 1.6431 
                        | Val Acc: 0.231 
                        | Val Counting Acc: 0.2309 
                        | Val Last Acc: 0.2375
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 1.6477
                            | Test Acc: 0.2175
                            | Test Counting Acc: 0.2176
                            | Test Last Acc: 0.208
                            | Test Unseen Len Acc: 0.2111
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 0.1431 
                    | Val Acc: 0.9434 
                    | Val Counting Acc: 0.9452 
                    | Val Last Acc: 0.8255
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.1675
                    | Test Acc: 0.6277
                    | Test Counting Acc: 0.6306
                    | Test Last Acc: 0.253
                    | Test Unseen Len Acc: 0.2905
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 0.1007 
                        | Val Acc: 0.9598 
                        | Val Counting Acc: 0.9609 
                        | Val Last Acc: 0.891
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 1.4198
                            | Test Acc: 0.6265
                            | Test Counting Acc: 0.6295
                            | Test Last Acc: 0.2537
                            | Test Unseen Len Acc: 0.2788
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 0.0736 
                    | Val Acc: 0.9711 
                    | Val Counting Acc: 0.9719 
                    | Val Last Acc: 0.921
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 1.5565
                    | Test Acc: 0.6432
                    | Test Counting Acc: 0.6462
                    | Test Last Acc: 0.26
                    | Test Unseen Len Acc: 0.301
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 0.1491 
                        | Val Acc: 0.9457 
                        | Val Counting Acc: 0.9473 
                        | Val Last Acc: 0.847
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 1.8535
                            | Test Acc: 0.6239
                            | Test Counting Acc: 0.6268
                            | Test Last Acc: 0.25
                            | Test Unseen Len Acc: 0.2941
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 0.0477 
                    | Val Acc: 0.981 
                    | Val Counting Acc: 0.9812 
                    | Val Last Acc: 0.969
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 2.0602
                    | Test Acc: 0.6537
                    | Test Counting Acc: 0.6569
                    | Test Last Acc: 0.252
                    | Test Unseen Len Acc: 0.316
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 0.0442 
                        | Val Acc: 0.9824 
                        | Val Counting Acc: 0.9823 
                        | Val Last Acc: 0.986
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 1.8819
                            | Test Acc: 0.6541
                            | Test Counting Acc: 0.6572
                            | Test Last Acc: 0.2573
                            | Test Unseen Len Acc: 0.3169
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 0.053 
                    | Val Acc: 0.9789 
                    | Val Counting Acc: 0.9791 
                    | Val Last Acc: 0.9665
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 1.8306
                    | Test Acc: 0.6579
                    | Test Counting Acc: 0.6611
                    | Test Last Acc: 0.26
                    | Test Unseen Len Acc: 0.326
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 0.1366 
                    | Val Acc: 0.9626 
                    | Val Counting Acc: 0.9636 
                    | Val Last Acc: 0.8985
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 2.1606
                    | Test Acc: 0.6259
                    | Test Counting Acc: 0.6289
                    | Test Last Acc: 0.248
                    | Test Unseen Len Acc: 0.2789
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 0.051 
                        | Val Acc: 0.9809 
                        | Val Counting Acc: 0.9809 
                        | Val Last Acc: 0.983
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 2.1189
                            | Test Acc: 0.6526
                            | Test Counting Acc: 0.6559
                            | Test Last Acc: 0.239
                            | Test Unseen Len Acc: 0.3131
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 0.0419 
                    | Val Acc: 0.9833 
                    | Val Counting Acc: 0.9832 
                    | Val Last Acc: 0.987
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 1.8386
                    | Test Acc: 0.6542
                    | Test Counting Acc: 0.6575
                    | Test Last Acc: 0.241
                    | Test Unseen Len Acc: 0.3167
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 0.0463 
                        | Val Acc: 0.9817 
                        | Val Counting Acc: 0.9818 
                        | Val Last Acc: 0.9745
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 1.8289
                            | Test Acc: 0.6561
                            | Test Counting Acc: 0.6593
                            | Test Last Acc: 0.251
                            | Test Unseen Len Acc: 0.3212
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 0.0456 
                    | Val Acc: 0.9818 
                    | Val Counting Acc: 0.9817 
                    | Val Last Acc: 0.989
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 2.0156
                    | Test Acc: 0.6536
                    | Test Counting Acc: 0.6568
                    | Test Last Acc: 0.2383
                    | Test Unseen Len Acc: 0.3151
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 0.0463 
                        | Val Acc: 0.9822 
                        | Val Counting Acc: 0.982 
                        | Val Last Acc: 0.9915
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 1.7957
                            | Test Acc: 0.658
                            | Test Counting Acc: 0.6613
                            | Test Last Acc: 0.2397
                            | Test Unseen Len Acc: 0.326
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 0.1083 
                    | Val Acc: 0.9641 
                    | Val Counting Acc: 0.965 
                    | Val Last Acc: 0.909
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 2.0293
                    | Test Acc: 0.6414
                    | Test Counting Acc: 0.6445
                    | Test Last Acc: 0.2477
                    | Test Unseen Len Acc: 0.3101
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 0.0472 
                        | Val Acc: 0.9812 
                        | Val Counting Acc: 0.9813 
                        | Val Last Acc: 0.9775
                        | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 1.8271
                            | Test Acc: 0.6581
                            | Test Counting Acc: 0.6614
                            | Test Last Acc: 0.2347
                            | Test Unseen Len Acc: 0.3263
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 0.0398 
                    | Val Acc: 0.9842 
                    | Val Counting Acc: 0.984 
                    | Val Last Acc: 0.9965
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 2.0249
                    | Test Acc: 0.6479
                    | Test Counting Acc: 0.6511
                    | Test Last Acc: 0.2403
                    | Test Unseen Len Acc: 0.3036
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 0.0398 
                    | Val Acc: 0.9841 
                    | Val Counting Acc: 0.9839 
                    | Val Last Acc: 0.9935
                    | Val Unseen Len Acc: -1
k = 3000, last_demo = 3000
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 1.884
                    | Test Acc: 0.6546
                    | Test Counting Acc: 0.6578
                    | Test Last Acc: 0.245
                    | Test Unseen Len Acc: 0.3172


------------- Start Inference -------------


---------------------- 0520_200112 ----------------------
max_seen_len for counting_selective_modular_4items = 64
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 0.1418 
                | Test Acc: 0.9439 
                | Test Counting Acc: 0.9457 
                | Test Last Acc: 0.8265
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.1666 
                | Test Acc: 0.628 
                | Test Counting Acc: 0.631 
                | Test Last Acc: 0.253
                | Test Unseen Len Acc: 0.2907
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 0.0736 
                | Test Acc: 0.9712 
                | Test Counting Acc: 0.972 
                | Test Last Acc: 0.9215
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 1.5563 
                | Test Acc: 0.6433 
                | Test Counting Acc: 0.6463 
                | Test Last Acc: 0.2603
                | Test Unseen Len Acc: 0.3009
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 0.0478 
                | Test Acc: 0.9811 
                | Test Counting Acc: 0.9813 
                | Test Last Acc: 0.9695
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 2.0605 
                | Test Acc: 0.6537 
                | Test Counting Acc: 0.6569 
                | Test Last Acc: 0.2517
                | Test Unseen Len Acc: 0.316
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 0.0535 
                | Test Acc: 0.9787 
                | Test Counting Acc: 0.9789 
                | Test Last Acc: 0.9665
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 1.8308 
                | Test Acc: 0.6579 
                | Test Counting Acc: 0.661 
                | Test Last Acc: 0.2603
                | Test Unseen Len Acc: 0.326
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 0.1351 
                | Test Acc: 0.9624 
                | Test Counting Acc: 0.9635 
                | Test Last Acc: 0.897
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 2.1621 
                | Test Acc: 0.6257 
                | Test Counting Acc: 0.6287 
                | Test Last Acc: 0.2473
                | Test Unseen Len Acc: 0.2785
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 0.0422 
                | Test Acc: 0.9832 
                | Test Counting Acc: 0.9832 
                | Test Last Acc: 0.987
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 1.8382 
                | Test Acc: 0.6543 
                | Test Counting Acc: 0.6575 
                | Test Last Acc: 0.242
                | Test Unseen Len Acc: 0.3169
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 0.0459 
                | Test Acc: 0.9818 
                | Test Counting Acc: 0.9817 
                | Test Last Acc: 0.989
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 2.0163 
                | Test Acc: 0.6535 
                | Test Counting Acc: 0.6568 
                | Test Last Acc: 0.238
                | Test Unseen Len Acc: 0.3151
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 0.1063 
                | Test Acc: 0.9644 
                | Test Counting Acc: 0.9652 
                | Test Last Acc: 0.91
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 2.0285 
                | Test Acc: 0.6417 
                | Test Counting Acc: 0.6448 
                | Test Last Acc: 0.2483
                | Test Unseen Len Acc: 0.3103
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 0.04 
                | Test Acc: 0.9842 
                | Test Counting Acc: 0.984 
                | Test Last Acc: 0.9965
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 2.024 
                | Test Acc: 0.648 
                | Test Counting Acc: 0.6512 
                | Test Last Acc: 0.24
                | Test Unseen Len Acc: 0.3039
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 0.04 
                | Test Acc: 0.9841 
                | Test Counting Acc: 0.9839 
                | Test Last Acc: 0.993
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 1.8846 
                | Test Acc: 0.6546 
                | Test Counting Acc: 0.6578 
                | Test Last Acc: 0.2457
                | Test Unseen Len Acc: 0.3171
            
Finish!!! 0520_200112
