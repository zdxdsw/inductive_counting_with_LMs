------------- Preparing model -------------
Total parameters: 12620800
Trainable parameters: 12620800
------------- Preparing data -------------
max_seen_len for counting_selective_10items_padhelper2 = 50
num train = 1000000
num val = 2000
------------ Start job 0521_020851 ------------
k = 2000, last_demo = 2000
Epoch 0 Step 0 
                        | Val Loss: 2.8182 
                        | Val Acc: 0.0891 
                        | Val Counting Acc: 0.0886 
                        | Val Last Acc: 0.1125
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 0 ood_test.txt
                            | Test Loss: 2.7461
                            | Test Acc: 0.1011
                            | Test Counting Acc: 0.1014
                            | Test Last Acc: 0.08
                            | Test Unseen Len Acc: 0.1303
k = 2000, last_demo = 2000
Epoch 0 Step 31250 
                    | Val Loss: 1.3531 
                    | Val Acc: 0.4474 
                    | Val Counting Acc: 0.4502 
                    | Val Last Acc: 0.3055
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 0 Step 31250 ood_test.txt
                    | Test Loss: 1.4204
                    | Test Acc: 0.4345
                    | Test Counting Acc: 0.4346
                    | Test Last Acc: 0.4225
                    | Test Unseen Len Acc: 0.3603
k = 2000, last_demo = 2000
Epoch 1 Step 40000 
                        | Val Loss: 1.3438 
                        | Val Acc: 0.4485 
                        | Val Counting Acc: 0.4511 
                        | Val Last Acc: 0.322
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 40000 ood_test.txt
                            | Test Loss: 1.3845
                            | Test Acc: 0.4422
                            | Test Counting Acc: 0.4422
                            | Test Last Acc: 0.4426
                            | Test Unseen Len Acc: 0.3826
k = 2000, last_demo = 2000
Epoch 1 Step 62500 
                    | Val Loss: 1.3348 
                    | Val Acc: 0.451 
                    | Val Counting Acc: 0.4537 
                    | Val Last Acc: 0.321
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 1 Step 62500 ood_test.txt
                    | Test Loss: 1.3927
                    | Test Acc: 0.4392
                    | Test Counting Acc: 0.4392
                    | Test Last Acc: 0.4353
                    | Test Unseen Len Acc: 0.3724
k = 2000, last_demo = 2000
Epoch 2 Step 80000 
                        | Val Loss: 1.3251 
                        | Val Acc: 0.4533 
                        | Val Counting Acc: 0.4559 
                        | Val Last Acc: 0.328
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 80000 ood_test.txt
                            | Test Loss: 1.3861
                            | Test Acc: 0.4398
                            | Test Counting Acc: 0.4398
                            | Test Last Acc: 0.4393
                            | Test Unseen Len Acc: 0.3723
k = 2000, last_demo = 2000
Epoch 2 Step 93750 
                    | Val Loss: 1.3222 
                    | Val Acc: 0.453 
                    | Val Counting Acc: 0.4555 
                    | Val Last Acc: 0.3305
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 2 Step 93750 ood_test.txt
                    | Test Loss: 1.3959
                    | Test Acc: 0.4354
                    | Test Counting Acc: 0.4356
                    | Test Last Acc: 0.4192
                    | Test Unseen Len Acc: 0.3606
k = 2000, last_demo = 2000
Epoch 3 Step 120000 
                        | Val Loss: 1.3116 
                        | Val Acc: 0.4541 
                        | Val Counting Acc: 0.4568 
                        | Val Last Acc: 0.3225
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 120000 ood_test.txt
                            | Test Loss: 1.3733
                            | Test Acc: 0.442
                            | Test Counting Acc: 0.442
                            | Test Last Acc: 0.4386
                            | Test Unseen Len Acc: 0.3769
k = 2000, last_demo = 2000
Epoch 3 Step 125000 
                    | Val Loss: 1.3151 
                    | Val Acc: 0.4518 
                    | Val Counting Acc: 0.4543 
                    | Val Last Acc: 0.329
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 3 Step 125000 ood_test.txt
                    | Test Loss: 1.3884
                    | Test Acc: 0.4374
                    | Test Counting Acc: 0.4375
                    | Test Last Acc: 0.4252
                    | Test Unseen Len Acc: 0.3665
k = 2000, last_demo = 2000
Epoch 4 Step 156250 
                    | Val Loss: 1.3107 
                    | Val Acc: 0.4513 
                    | Val Counting Acc: 0.4539 
                    | Val Last Acc: 0.325
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 4 Step 156250 ood_test.txt
                    | Test Loss: 1.4002
                    | Test Acc: 0.4372
                    | Test Counting Acc: 0.4375
                    | Test Last Acc: 0.4139
                    | Test Unseen Len Acc: 0.3682
k = 2000, last_demo = 2000
Epoch 5 Step 160000 
                        | Val Loss: 1.3116 
                        | Val Acc: 0.4502 
                        | Val Counting Acc: 0.4529 
                        | Val Last Acc: 0.3175
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 160000 ood_test.txt
                            | Test Loss: 1.3838
                            | Test Acc: 0.4363
                            | Test Counting Acc: 0.4368
                            | Test Last Acc: 0.3975
                            | Test Unseen Len Acc: 0.3641
k = 2000, last_demo = 2000
Epoch 5 Step 187500 
                    | Val Loss: 1.3027 
                    | Val Acc: 0.4535 
                    | Val Counting Acc: 0.456 
                    | Val Last Acc: 0.3275
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 5 Step 187500 ood_test.txt
                    | Test Loss: 1.412
                    | Test Acc: 0.4288
                    | Test Counting Acc: 0.4309
                    | Test Last Acc: 0.2687
                    | Test Unseen Len Acc: 0.3379
k = 2000, last_demo = 2000
Epoch 6 Step 200000 
                        | Val Loss: 1.308 
                        | Val Acc: 0.4516 
                        | Val Counting Acc: 0.4542 
                        | Val Last Acc: 0.3255
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 200000 ood_test.txt
                            | Test Loss: 1.4268
                            | Test Acc: 0.4267
                            | Test Counting Acc: 0.4291
                            | Test Last Acc: 0.2469
                            | Test Unseen Len Acc: 0.335
k = 2000, last_demo = 2000
Epoch 6 Step 218750 
                    | Val Loss: 1.3028 
                    | Val Acc: 0.4517 
                    | Val Counting Acc: 0.4545 
                    | Val Last Acc: 0.317
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 6 Step 218750 ood_test.txt
                    | Test Loss: 1.4414
                    | Test Acc: 0.4245
                    | Test Counting Acc: 0.427
                    | Test Last Acc: 0.2402
                    | Test Unseen Len Acc: 0.3278
k = 2000, last_demo = 2000
Epoch 7 Step 240000 
                        | Val Loss: 1.2987 
                        | Val Acc: 0.4522 
                        | Val Counting Acc: 0.4547 
                        | Val Last Acc: 0.3265
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 240000 ood_test.txt
                            | Test Loss: 1.4272
                            | Test Acc: 0.4255
                            | Test Counting Acc: 0.4281
                            | Test Last Acc: 0.2349
                            | Test Unseen Len Acc: 0.3312
k = 2000, last_demo = 2000
Epoch 7 Step 250000 
                    | Val Loss: 1.3013 
                    | Val Acc: 0.4517 
                    | Val Counting Acc: 0.4544 
                    | Val Last Acc: 0.318
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 7 Step 250000 ood_test.txt
                    | Test Loss: 1.4104
                    | Test Acc: 0.428
                    | Test Counting Acc: 0.4303
                    | Test Last Acc: 0.2566
                    | Test Unseen Len Acc: 0.3383
k = 2000, last_demo = 2000
Epoch 8 Step 280000 
                        | Val Loss: 1.2974 
                        | Val Acc: 0.4518 
                        | Val Counting Acc: 0.4545 
                        | Val Last Acc: 0.3225
                        | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 280000 ood_test.txt
                            | Test Loss: 1.4329
                            | Test Acc: 0.4272
                            | Test Counting Acc: 0.4298
                            | Test Last Acc: 0.2342
                            | Test Unseen Len Acc: 0.3346
k = 2000, last_demo = 2000
Epoch 8 Step 281250 
                    | Val Loss: 1.2962 
                    | Val Acc: 0.4537 
                    | Val Counting Acc: 0.4564 
                    | Val Last Acc: 0.3235
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 8 Step 281250 ood_test.txt
                    | Test Loss: 1.4487
                    | Test Acc: 0.4247
                    | Test Counting Acc: 0.4273
                    | Test Last Acc: 0.2335
                    | Test Unseen Len Acc: 0.3269
k = 2000, last_demo = 2000
Epoch 9 Step 312500 
                    | Val Loss: 1.2938 
                    | Val Acc: 0.4523 
                    | Val Counting Acc: 0.455 
                    | Val Last Acc: 0.3205
                    | Val Unseen Len Acc: -1
k = 2989, last_demo = 2989
Epoch 9 Step 312500 ood_test.txt
                    | Test Loss: 1.4549
                    | Test Acc: 0.424
                    | Test Counting Acc: 0.4266
                    | Test Last Acc: 0.2295
                    | Test Unseen Len Acc: 0.3264


------------- Start Inference -------------


---------------------- 0521_020851 ----------------------
max_seen_len for counting_selective_10items_padhelper2 = 50
 val acc, load from 0_31250_transformer.pt
                | Test Loss: 1.3537 
                | Test Acc: 0.4474 
                | Test Counting Acc: 0.4503 
                | Test Last Acc: 0.304
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 0_31250_transformer.pt
                | Test Loss: 1.4202 
                | Test Acc: 0.4344 
                | Test Counting Acc: 0.4346 
                | Test Last Acc: 0.4229
                | Test Unseen Len Acc: 0.3601
            
 val acc, load from 1_62500_transformer.pt
                | Test Loss: 1.3352 
                | Test Acc: 0.4512 
                | Test Counting Acc: 0.4539 
                | Test Last Acc: 0.3205
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 1_62500_transformer.pt
                | Test Loss: 1.3921 
                | Test Acc: 0.4392 
                | Test Counting Acc: 0.4393 
                | Test Last Acc: 0.4353
                | Test Unseen Len Acc: 0.3725
            
 val acc, load from 2_93750_transformer.pt
                | Test Loss: 1.3225 
                | Test Acc: 0.4531 
                | Test Counting Acc: 0.4556 
                | Test Last Acc: 0.3305
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 2_93750_transformer.pt
                | Test Loss: 1.3954 
                | Test Acc: 0.4354 
                | Test Counting Acc: 0.4356 
                | Test Last Acc: 0.4192
                | Test Unseen Len Acc: 0.3607
            
 val acc, load from 3_125000_transformer.pt
                | Test Loss: 1.3157 
                | Test Acc: 0.4517 
                | Test Counting Acc: 0.4542 
                | Test Last Acc: 0.328
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 3_125000_transformer.pt
                | Test Loss: 1.3879 
                | Test Acc: 0.4374 
                | Test Counting Acc: 0.4375 
                | Test Last Acc: 0.4252
                | Test Unseen Len Acc: 0.3665
            
 val acc, load from 4_156250_transformer.pt
                | Test Loss: 1.3113 
                | Test Acc: 0.4514 
                | Test Counting Acc: 0.4539 
                | Test Last Acc: 0.325
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 4_156250_transformer.pt
                | Test Loss: 1.3995 
                | Test Acc: 0.4371 
                | Test Counting Acc: 0.4375 
                | Test Last Acc: 0.4145
                | Test Unseen Len Acc: 0.3681
            
 val acc, load from 5_187500_transformer.pt
                | Test Loss: 1.3032 
                | Test Acc: 0.4535 
                | Test Counting Acc: 0.4561 
                | Test Last Acc: 0.328
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 5_187500_transformer.pt
                | Test Loss: 1.4115 
                | Test Acc: 0.4287 
                | Test Counting Acc: 0.4309 
                | Test Last Acc: 0.2687
                | Test Unseen Len Acc: 0.3378
            
 val acc, load from 6_218750_transformer.pt
                | Test Loss: 1.3036 
                | Test Acc: 0.4515 
                | Test Counting Acc: 0.4543 
                | Test Last Acc: 0.317
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 6_218750_transformer.pt
                | Test Loss: 1.4409 
                | Test Acc: 0.4245 
                | Test Counting Acc: 0.427 
                | Test Last Acc: 0.2392
                | Test Unseen Len Acc: 0.3278
            
 val acc, load from 7_250000_transformer.pt
                | Test Loss: 1.3019 
                | Test Acc: 0.4515 
                | Test Counting Acc: 0.4542 
                | Test Last Acc: 0.3185
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 7_250000_transformer.pt
                | Test Loss: 1.4099 
                | Test Acc: 0.428 
                | Test Counting Acc: 0.4303 
                | Test Last Acc: 0.2556
                | Test Unseen Len Acc: 0.3384
            
 val acc, load from 8_281250_transformer.pt
                | Test Loss: 1.2966 
                | Test Acc: 0.4538 
                | Test Counting Acc: 0.4565 
                | Test Last Acc: 0.3235
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 8_281250_transformer.pt
                | Test Loss: 1.4474 
                | Test Acc: 0.4248 
                | Test Counting Acc: 0.4274 
                | Test Last Acc: 0.2339
                | Test Unseen Len Acc: 0.3271
            
 val acc, load from 9_312500_transformer.pt
                | Test Loss: 1.2945 
                | Test Acc: 0.4521 
                | Test Counting Acc: 0.4548 
                | Test Last Acc: 0.3215
                | Test Unseen Len Acc: -1
            
 ood_test acc, load from 9_312500_transformer.pt
                | Test Loss: 1.4538 
                | Test Acc: 0.424 
                | Test Counting Acc: 0.4266 
                | Test Last Acc: 0.2288
                | Test Unseen Len Acc: 0.3266
            
Finish!!! 0521_020851
